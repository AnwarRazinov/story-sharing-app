/*! For license information please see bundle.a41a1abdaf94ee66c352.js.LICENSE.txt */
(()=>{"use strict";var t={56:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},72:t=>{var e=[];function n(t){for(var n=-1,r=0;r<e.length;r++)if(e[r].identifier===t){n=r;break}return n}function r(t,r){for(var i={},a=[],c=0;c<t.length;c++){var s=t[c],u=r.base?s[0]+r.base:s[0],l=i[u]||0,f="".concat(u," ").concat(l);i[u]=l+1;var h=n(f),p={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==h)e[h].references++,e[h].updater(p);else{var d=o(p,r);r.byIndex=c,e.splice(c,0,{identifier:f,updater:d,references:1})}a.push(f)}return a}function o(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,o){var i=r(t=t||[],o=o||{});return function(t){t=t||[];for(var a=0;a<i.length;a++){var c=n(i[a]);e[c].references--}for(var s=r(t,o),u=0;u<i.length;u++){var l=n(i[u]);0===e[l].references&&(e[l].updater(),e.splice(l,1))}i=s}}},113:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},249:(t,e,n)=>{n.d(e,{A:()=>c});var r=n(601),o=n.n(r),i=n(314),a=n.n(i)()(o());a.push([t.id,"/* Reset dan base styles */\n* {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n}\n\n:root {\n    --primary-color: #2196F3;\n    --secondary-color: #1976D2;\n    --accent-color: #FF5722;\n    --text-color: #333;\n    --text-light: #666;\n    --bg-color: #f5f5f5;\n    --white: #ffffff;\n    --error-color: #f44336;\n    --success-color: #4CAF50;\n    --border-radius: 8px;\n    --transition: all 0.3s ease;\n}\n\nbody {\n    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n    line-height: 1.6;\n    color: var(--text-color);\n    background-color: var(--bg-color);\n}\n\n/* Skip to Content */\n.visually-hidden {\n    position: absolute;\n    width: 1px;\n    height: 1px;\n    padding: 0;\n    margin: -1px;\n    overflow: hidden;\n    clip: rect(0, 0, 0, 0);\n    white-space: nowrap;\n    border: 0;\n}\n\n.skip-to-content {\n    position: absolute;\n    top: 0;\n    left: 0;\n    background: var(--primary-color);\n    color: var(--white);\n    padding: 8px 16px;\n    z-index: 100;\n    transform: translateY(-100%);\n    transition: transform 0.3s ease-out;\n    border-radius: 0 0 4px 0;\n    text-decoration: none;\n}\n\n.skip-to-content:focus {\n    transform: translateY(0);\n    outline: 2px solid var(--white);\n    outline-offset: -2px;\n}\n\n/* Untuk browser yang tidak mendukung :focus-visible */\n.skip-to-content.focused {\n    transform: translateY(0);\n}\n\n/* Main container */\n#app {\n    min-height: 100vh;\n    display: flex;\n    flex-direction: column;\n}\n\nmain {\n    flex: 1;\n    padding: 20px;\n    max-width: 1200px;\n    margin: 0 auto;\n    width: 100%;\n}\n\n/* Konten utama */\n#main-content:focus {\n    outline: none;\n}\n\n/* Navigation */\n.main-navigation {\n    background: var(--white);\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n    padding: 1rem;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n}\n\n.nav-brand a {\n    font-size: 1.5rem;\n    font-weight: bold;\n    color: var(--primary-color);\n    text-decoration: none;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n.nav-links {\n    display: flex;\n    list-style: none;\n    gap: 1.5rem;\n}\n\n.nav-links a {\n    text-decoration: none;\n    color: var(--text-color);\n    transition: var(--transition);\n    padding: 0.5rem;\n}\n\n.nav-links a.active,\n.nav-links a:hover {\n    color: var(--primary-color);\n}\n\n/* Buttons */\n.btn {\n    display: inline-block;\n    padding: 0.5rem 1rem;\n    border-radius: var(--border-radius);\n    text-decoration: none;\n    transition: var(--transition);\n    border: none;\n    cursor: pointer;\n    font-size: 1rem;\n    text-align: center;\n}\n\n.btn-primary {\n    background: var(--primary-color);\n    color: var(--white);\n}\n\n.btn-primary:hover {\n    background: var(--secondary-color);\n}\n\n.btn-secondary {\n    background: transparent;\n    border: 1px solid var(--primary-color);\n    color: var(--primary-color);\n}\n\n.btn-secondary:hover {\n    background: var(--primary-color);\n    color: var(--white);\n}\n\n.btn-danger {\n    background: #f44336;\n    color: white;\n    border: none;\n}\n\n.btn-danger:hover {\n    background: #d32f2f;\n}\n\n.camera-controls {\n    display: flex;\n    gap: 0.5rem;\n    flex-wrap: wrap;\n    margin-top: 1rem;\n}\n\n.camera-controls .btn {\n    flex: 1;\n    min-width: fit-content;\n}\n\n/* Forms */\n.form-group {\n    margin-bottom: 1.5rem;\n}\n\n.form-control {\n    width: 100%;\n    padding: 0.75rem;\n    border: 1px solid #ddd;\n    border-radius: var(--border-radius);\n    font-size: 1rem;\n}\n\n.form-control:focus {\n    outline: none;\n    border-color: var(--primary-color);\n    box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.2);\n}\n\n.error-message {\n    color: var(--error-color);\n    font-size: 0.875rem;\n    margin-top: 0.25rem;\n    display: none;\n}\n\n/* Story Card */\n.story-card {\n    background: var(--white);\n    border-radius: var(--border-radius);\n    overflow: hidden;\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n    transition: var(--transition);\n}\n\n.story-card:hover {\n    transform: translateY(-4px);\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n}\n\n.story-image img,\n#photo-preview {\n    max-width: 100%;\n    max-height: 400px;\n    object-fit: contain;\n    display: block;\n    margin: 0 auto;\n}\n\n.photo-preview-container {\n    max-width: 100%;\n    overflow: hidden;\n}\n\n#photo-preview {\n    max-height: 300px;\n    width: auto;\n}\n\n.story-content {\n    padding: 1.5rem;\n}\n\n.story-author {\n    font-size: 1.25rem;\n    margin-bottom: 0.5rem;\n}\n\n.story-description {\n    color: var(--text-light);\n    margin-bottom: 1rem;\n}\n\n.story-meta {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n}\n\n/* Maps */\n.stories-map,\n.location-map,\n.story-map {\n    height: 400px;\n    border-radius: var(--border-radius);\n    margin-bottom: 2rem;\n}\n\n/* Skeleton loading */\n.skeleton {\n    animation: skeleton-loading 1s linear infinite alternate;\n}\n\n.skeleton-box {\n    background: #ddd;\n    border-radius: 4px;\n}\n\n/* Tambahkan styling untuk active link */\n.nav-links a.active {\n    color: var(--primary-color);\n    font-weight: bold;\n    position: relative;\n}\n\n.nav-links a.active::after {\n    content: '';\n    position: absolute;\n    bottom: -2px;\n    left: 0;\n    width: 100%;\n    height: 2px;\n    background-color: var(--primary-color);\n}\n\n/* Styling untuk prompt auth */\n.auth-prompt {\n    text-align: center;\n    margin: 2rem 0;\n    padding: 1rem;\n    background: var(--white);\n    border-radius: var(--border-radius);\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n}\n\n.auth-prompt a {\n    color: var(--primary-color);\n    text-decoration: none;\n}\n\n.auth-prompt a:hover {\n    text-decoration: underline;\n}\n\n.auth-actions {\n    display: flex;\n    gap: 1rem;\n    justify-content: center;\n}\n\n.no-stories {\n    text-align: center;\n    padding: 2rem;\n    background: var(--white);\n    border-radius: var(--border-radius);\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n}\n\n.no-stories i {\n    color: var(--text-light);\n    margin-bottom: 1rem;\n}\n\n.no-stories p {\n    margin-bottom: 1.5rem;\n    color: var(--text-light);\n}\n\n.user-menu {\n    position: relative;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    cursor: pointer;\n}\n\n.user-avatar {\n    width: 36px;\n    height: 36px;\n    border-radius: 50%;\n    background-color: var(--primary-color);\n    color: white;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-weight: bold;\n}\n\n.user-dropdown {\n    display: flex;\n    flex-direction: column;\n}\n\n.user-name {\n    font-weight: 500;\n}\n\n.btn-logout {\n    background: none;\n    border: none;\n    color: var(--text-light);\n    cursor: pointer;\n    text-align: left;\n    padding: 0;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n.btn-logout:hover {\n    color: var(--error-color);\n}\n\n.guest-notice {\n    background: #fff3e0;\n    padding: 0.5rem;\n    border-radius: var(--border-radius);\n    margin-top: 1rem;\n    font-size: 0.9rem;\n}\n\n.guest-notice a {\n    color: var(--secondary-color);\n    font-weight: 500;\n}\n\n@keyframes skeleton-loading {\n    0% {\n        opacity: 0.7;\n    }\n\n    100% {\n        opacity: 1;\n    }\n}\n\n/* View Transitions */\n::view-transition-old(root) {\n    animation: fade-out 0.3s ease-out;\n}\n\n::view-transition-new(root) {\n    animation: fade-in 0.3s ease-in;\n}\n\n@keyframes fade-out {\n    from {\n        opacity: 1;\n    }\n\n    to {\n        opacity: 0;\n    }\n}\n\n@keyframes fade-in {\n    from {\n        opacity: 0;\n    }\n\n    to {\n        opacity: 1;\n    }\n}\n\n/* Responsive */\n@media (max-width: 768px) {\n    .main-navigation {\n        flex-wrap: wrap;\n    }\n\n    .nav-links {\n        display: none;\n        width: 100%;\n        flex-direction: column;\n        margin-top: 1rem;\n    }\n\n    .main-navigation.open .nav-links {\n        display: flex;\n    }\n\n    .mobile-menu-toggle {\n        display: block;\n    }\n\n    .story-card {\n        margin-bottom: 1rem;\n    }\n}\n\n@media (min-width: 769px) {\n    .mobile-menu-toggle {\n        display: none;\n    }\n\n    .stories-list {\n        display: grid;\n        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));\n        gap: 1.5rem;\n    }\n}",""]);const c=a},314:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",r=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),r&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),r&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,r,o,i){"string"==typeof t&&(t=[[null,t,void 0]]);var a={};if(r)for(var c=0;c<this.length;c++){var s=this[c][0];null!=s&&(a[s]=!0)}for(var u=0;u<t.length;u++){var l=[].concat(t[u]);r&&a[l[0]]||(void 0!==i&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=i),n&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=n):l[2]=n),o&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=o):l[4]="".concat(o)),e.push(l))}},e}},540:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},601:t=>{t.exports=function(t){return t[1]}},659:t=>{var e={};t.exports=function(t,n){var r=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},825:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,o&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleTagTransform(r,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={id:r,exports:{}};return t[r](i,i.exports,n),i.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nc=void 0;var r=n(72),o=n.n(r),i=n(825),a=n.n(i),c=n(659),s=n.n(c),u=n(56),l=n.n(u),f=n(540),h=n.n(f),p=n(113),d=n.n(p),v=n(249),y={};y.styleTagTransform=d(),y.setAttributes=l(),y.insert=s().bind(null,"head"),y.domAPI=a(),y.insertStyleElement=h(),o()(v.A,y),v.A&&v.A.locals&&v.A.locals;const{entries:m,setPrototypeOf:g,isFrozen:b,getPrototypeOf:w,getOwnPropertyDescriptor:x}=Object;let{freeze:E,seal:k,create:S}=Object,{apply:O,construct:T}="undefined"!=typeof Reflect&&Reflect;E||(E=function(t){return t}),k||(k=function(t){return t}),O||(O=function(t,e,n){return t.apply(e,n)}),T||(T=function(t,e){return new t(...e)});const P=H(Array.prototype.forEach),_=H(Array.prototype.lastIndexOf),j=H(Array.prototype.pop),A=H(Array.prototype.push),N=H(Array.prototype.splice),C=H(String.prototype.toLowerCase),I=H(String.prototype.toString),M=H(String.prototype.match),F=H(String.prototype.replace),D=H(String.prototype.indexOf),R=H(String.prototype.trim),G=H(Object.prototype.hasOwnProperty),B=H(RegExp.prototype.test),z=(U=TypeError,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return T(U,e)});var U;function H(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return O(t,e,r)}}function q(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:C;g&&g(t,null);let r=e.length;for(;r--;){let o=e[r];if("string"==typeof o){const t=n(o);t!==o&&(b(e)||(e[r]=t),o=t)}t[o]=!0}return t}function W(t){for(let e=0;e<t.length;e++)G(t,e)||(t[e]=null);return t}function Y(t){const e=S(null);for(const[n,r]of m(t))G(t,n)&&(Array.isArray(r)?e[n]=W(r):r&&"object"==typeof r&&r.constructor===Object?e[n]=Y(r):e[n]=r);return e}function V(t,e){for(;null!==t;){const n=x(t,e);if(n){if(n.get)return H(n.get);if("function"==typeof n.value)return H(n.value)}t=w(t)}return function(){return null}}const K=E(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),J=E(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),X=E(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),$=E(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Z=E(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Q=E(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),tt=E(["#text"]),et=E(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),nt=E(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),rt=E(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),ot=E(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),it=k(/\{\{[\w\W]*|[\w\W]*\}\}/gm),at=k(/<%[\w\W]*|[\w\W]*%>/gm),ct=k(/\$\{[\w\W]*/gm),st=k(/^data-[\-\w.\u00B7-\uFFFF]+$/),ut=k(/^aria-[\-\w]+$/),lt=k(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),ft=k(/^(?:\w+script|data):/i),ht=k(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),pt=k(/^html$/i),dt=k(/^[a-z][.\w]*(-[.\w]+)+$/i);var vt=Object.freeze({__proto__:null,ARIA_ATTR:ut,ATTR_WHITESPACE:ht,CUSTOM_ELEMENT:dt,DATA_ATTR:st,DOCTYPE_NAME:pt,ERB_EXPR:at,IS_ALLOWED_URI:lt,IS_SCRIPT_OR_DATA:ft,MUSTACHE_EXPR:it,TMPLIT_EXPR:ct});const yt=function(){return"undefined"==typeof window?null:window};var mt=function t(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yt();const n=e=>t(e);if(n.version="3.2.5",n.removed=[],!e||!e.document||9!==e.document.nodeType||!e.Element)return n.isSupported=!1,n;let{document:r}=e;const o=r,i=o.currentScript,{DocumentFragment:a,HTMLTemplateElement:c,Node:s,Element:u,NodeFilter:l,NamedNodeMap:f=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:h,DOMParser:p,trustedTypes:d}=e,v=u.prototype,y=V(v,"cloneNode"),g=V(v,"remove"),b=V(v,"nextSibling"),w=V(v,"childNodes"),x=V(v,"parentNode");if("function"==typeof c){const t=r.createElement("template");t.content&&t.content.ownerDocument&&(r=t.content.ownerDocument)}let k,O="";const{implementation:T,createNodeIterator:L,createDocumentFragment:U,getElementsByTagName:H}=r,{importNode:W}=o;let it={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]};n.isSupported="function"==typeof m&&"function"==typeof x&&T&&void 0!==T.createHTMLDocument;const{MUSTACHE_EXPR:at,ERB_EXPR:ct,TMPLIT_EXPR:st,DATA_ATTR:ut,ARIA_ATTR:ft,IS_SCRIPT_OR_DATA:ht,ATTR_WHITESPACE:dt,CUSTOM_ELEMENT:mt}=vt;let{IS_ALLOWED_URI:gt}=vt,bt=null;const wt=q({},[...K,...J,...X,...Z,...tt]);let xt=null;const Et=q({},[...et,...nt,...rt,...ot]);let kt=Object.seal(S(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),St=null,Ot=null,Tt=!0,Pt=!0,_t=!1,jt=!0,At=!1,Lt=!0,Nt=!1,Ct=!1,It=!1,Mt=!1,Ft=!1,Dt=!1,Rt=!0,Gt=!1,Bt=!0,zt=!1,Ut={},Ht=null;const qt=q({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Wt=null;const Yt=q({},["audio","video","img","source","image","track"]);let Vt=null;const Kt=q({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Jt="http://www.w3.org/1998/Math/MathML",Xt="http://www.w3.org/2000/svg",$t="http://www.w3.org/1999/xhtml";let Zt=$t,Qt=!1,te=null;const ee=q({},[Jt,Xt,$t],I);let ne=q({},["mi","mo","mn","ms","mtext"]),re=q({},["annotation-xml"]);const oe=q({},["title","style","font","a","script"]);let ie=null;const ae=["application/xhtml+xml","text/html"];let ce=null,se=null;const ue=r.createElement("form"),le=function(t){return t instanceof RegExp||t instanceof Function},fe=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!se||se!==t){if(t&&"object"==typeof t||(t={}),t=Y(t),ie=-1===ae.indexOf(t.PARSER_MEDIA_TYPE)?"text/html":t.PARSER_MEDIA_TYPE,ce="application/xhtml+xml"===ie?I:C,bt=G(t,"ALLOWED_TAGS")?q({},t.ALLOWED_TAGS,ce):wt,xt=G(t,"ALLOWED_ATTR")?q({},t.ALLOWED_ATTR,ce):Et,te=G(t,"ALLOWED_NAMESPACES")?q({},t.ALLOWED_NAMESPACES,I):ee,Vt=G(t,"ADD_URI_SAFE_ATTR")?q(Y(Kt),t.ADD_URI_SAFE_ATTR,ce):Kt,Wt=G(t,"ADD_DATA_URI_TAGS")?q(Y(Yt),t.ADD_DATA_URI_TAGS,ce):Yt,Ht=G(t,"FORBID_CONTENTS")?q({},t.FORBID_CONTENTS,ce):qt,St=G(t,"FORBID_TAGS")?q({},t.FORBID_TAGS,ce):{},Ot=G(t,"FORBID_ATTR")?q({},t.FORBID_ATTR,ce):{},Ut=!!G(t,"USE_PROFILES")&&t.USE_PROFILES,Tt=!1!==t.ALLOW_ARIA_ATTR,Pt=!1!==t.ALLOW_DATA_ATTR,_t=t.ALLOW_UNKNOWN_PROTOCOLS||!1,jt=!1!==t.ALLOW_SELF_CLOSE_IN_ATTR,At=t.SAFE_FOR_TEMPLATES||!1,Lt=!1!==t.SAFE_FOR_XML,Nt=t.WHOLE_DOCUMENT||!1,Mt=t.RETURN_DOM||!1,Ft=t.RETURN_DOM_FRAGMENT||!1,Dt=t.RETURN_TRUSTED_TYPE||!1,It=t.FORCE_BODY||!1,Rt=!1!==t.SANITIZE_DOM,Gt=t.SANITIZE_NAMED_PROPS||!1,Bt=!1!==t.KEEP_CONTENT,zt=t.IN_PLACE||!1,gt=t.ALLOWED_URI_REGEXP||lt,Zt=t.NAMESPACE||$t,ne=t.MATHML_TEXT_INTEGRATION_POINTS||ne,re=t.HTML_INTEGRATION_POINTS||re,kt=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&le(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(kt.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&le(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(kt.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(kt.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),At&&(Pt=!1),Ft&&(Mt=!0),Ut&&(bt=q({},tt),xt=[],!0===Ut.html&&(q(bt,K),q(xt,et)),!0===Ut.svg&&(q(bt,J),q(xt,nt),q(xt,ot)),!0===Ut.svgFilters&&(q(bt,X),q(xt,nt),q(xt,ot)),!0===Ut.mathMl&&(q(bt,Z),q(xt,rt),q(xt,ot))),t.ADD_TAGS&&(bt===wt&&(bt=Y(bt)),q(bt,t.ADD_TAGS,ce)),t.ADD_ATTR&&(xt===Et&&(xt=Y(xt)),q(xt,t.ADD_ATTR,ce)),t.ADD_URI_SAFE_ATTR&&q(Vt,t.ADD_URI_SAFE_ATTR,ce),t.FORBID_CONTENTS&&(Ht===qt&&(Ht=Y(Ht)),q(Ht,t.FORBID_CONTENTS,ce)),Bt&&(bt["#text"]=!0),Nt&&q(bt,["html","head","body"]),bt.table&&(q(bt,["tbody"]),delete St.tbody),t.TRUSTED_TYPES_POLICY){if("function"!=typeof t.TRUSTED_TYPES_POLICY.createHTML)throw z('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof t.TRUSTED_TYPES_POLICY.createScriptURL)throw z('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');k=t.TRUSTED_TYPES_POLICY,O=k.createHTML("")}else void 0===k&&(k=function(t,e){if("object"!=typeof t||"function"!=typeof t.createPolicy)return null;let n=null;const r="data-tt-policy-suffix";e&&e.hasAttribute(r)&&(n=e.getAttribute(r));const o="dompurify"+(n?"#"+n:"");try{return t.createPolicy(o,{createHTML:t=>t,createScriptURL:t=>t})}catch(t){return console.warn("TrustedTypes policy "+o+" could not be created."),null}}(d,i)),null!==k&&"string"==typeof O&&(O=k.createHTML(""));E&&E(t),se=t}},he=q({},[...J,...X,...$]),pe=q({},[...Z,...Q]),de=function(t){A(n.removed,{element:t});try{x(t).removeChild(t)}catch(e){g(t)}},ve=function(t,e){try{A(n.removed,{attribute:e.getAttributeNode(t),from:e})}catch(t){A(n.removed,{attribute:null,from:e})}if(e.removeAttribute(t),"is"===t)if(Mt||Ft)try{de(e)}catch(t){}else try{e.setAttribute(t,"")}catch(t){}},ye=function(t){let e=null,n=null;if(It)t="<remove></remove>"+t;else{const e=M(t,/^[\r\n\t ]+/);n=e&&e[0]}"application/xhtml+xml"===ie&&Zt===$t&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");const o=k?k.createHTML(t):t;if(Zt===$t)try{e=(new p).parseFromString(o,ie)}catch(t){}if(!e||!e.documentElement){e=T.createDocument(Zt,"template",null);try{e.documentElement.innerHTML=Qt?O:o}catch(t){}}const i=e.body||e.documentElement;return t&&n&&i.insertBefore(r.createTextNode(n),i.childNodes[0]||null),Zt===$t?H.call(e,Nt?"html":"body")[0]:Nt?e.documentElement:i},me=function(t){return L.call(t.ownerDocument||t,t,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT|l.SHOW_PROCESSING_INSTRUCTION|l.SHOW_CDATA_SECTION,null)},ge=function(t){return t instanceof h&&("string"!=typeof t.nodeName||"string"!=typeof t.textContent||"function"!=typeof t.removeChild||!(t.attributes instanceof f)||"function"!=typeof t.removeAttribute||"function"!=typeof t.setAttribute||"string"!=typeof t.namespaceURI||"function"!=typeof t.insertBefore||"function"!=typeof t.hasChildNodes)},be=function(t){return"function"==typeof s&&t instanceof s};function we(t,e,r){P(t,(t=>{t.call(n,e,r,se)}))}const xe=function(t){let e=null;if(we(it.beforeSanitizeElements,t,null),ge(t))return de(t),!0;const r=ce(t.nodeName);if(we(it.uponSanitizeElement,t,{tagName:r,allowedTags:bt}),t.hasChildNodes()&&!be(t.firstElementChild)&&B(/<[/\w!]/g,t.innerHTML)&&B(/<[/\w!]/g,t.textContent))return de(t),!0;if(7===t.nodeType)return de(t),!0;if(Lt&&8===t.nodeType&&B(/<[/\w]/g,t.data))return de(t),!0;if(!bt[r]||St[r]){if(!St[r]&&ke(r)){if(kt.tagNameCheck instanceof RegExp&&B(kt.tagNameCheck,r))return!1;if(kt.tagNameCheck instanceof Function&&kt.tagNameCheck(r))return!1}if(Bt&&!Ht[r]){const e=x(t)||t.parentNode,n=w(t)||t.childNodes;if(n&&e)for(let r=n.length-1;r>=0;--r){const o=y(n[r],!0);o.__removalCount=(t.__removalCount||0)+1,e.insertBefore(o,b(t))}}return de(t),!0}return t instanceof u&&!function(t){let e=x(t);e&&e.tagName||(e={namespaceURI:Zt,tagName:"template"});const n=C(t.tagName),r=C(e.tagName);return!!te[t.namespaceURI]&&(t.namespaceURI===Xt?e.namespaceURI===$t?"svg"===n:e.namespaceURI===Jt?"svg"===n&&("annotation-xml"===r||ne[r]):Boolean(he[n]):t.namespaceURI===Jt?e.namespaceURI===$t?"math"===n:e.namespaceURI===Xt?"math"===n&&re[r]:Boolean(pe[n]):t.namespaceURI===$t?!(e.namespaceURI===Xt&&!re[r])&&!(e.namespaceURI===Jt&&!ne[r])&&!pe[n]&&(oe[n]||!he[n]):!("application/xhtml+xml"!==ie||!te[t.namespaceURI]))}(t)?(de(t),!0):"noscript"!==r&&"noembed"!==r&&"noframes"!==r||!B(/<\/no(script|embed|frames)/i,t.innerHTML)?(At&&3===t.nodeType&&(e=t.textContent,P([at,ct,st],(t=>{e=F(e,t," ")})),t.textContent!==e&&(A(n.removed,{element:t.cloneNode()}),t.textContent=e)),we(it.afterSanitizeElements,t,null),!1):(de(t),!0)},Ee=function(t,e,n){if(Rt&&("id"===e||"name"===e)&&(n in r||n in ue))return!1;if(Pt&&!Ot[e]&&B(ut,e));else if(Tt&&B(ft,e));else if(!xt[e]||Ot[e]){if(!(ke(t)&&(kt.tagNameCheck instanceof RegExp&&B(kt.tagNameCheck,t)||kt.tagNameCheck instanceof Function&&kt.tagNameCheck(t))&&(kt.attributeNameCheck instanceof RegExp&&B(kt.attributeNameCheck,e)||kt.attributeNameCheck instanceof Function&&kt.attributeNameCheck(e))||"is"===e&&kt.allowCustomizedBuiltInElements&&(kt.tagNameCheck instanceof RegExp&&B(kt.tagNameCheck,n)||kt.tagNameCheck instanceof Function&&kt.tagNameCheck(n))))return!1}else if(Vt[e]);else if(B(gt,F(n,dt,"")));else if("src"!==e&&"xlink:href"!==e&&"href"!==e||"script"===t||0!==D(n,"data:")||!Wt[t])if(_t&&!B(ht,F(n,dt,"")));else if(n)return!1;return!0},ke=function(t){return"annotation-xml"!==t&&M(t,mt)},Se=function(t){we(it.beforeSanitizeAttributes,t,null);const{attributes:e}=t;if(!e||ge(t))return;const r={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:xt,forceKeepAttr:void 0};let o=e.length;for(;o--;){const i=e[o],{name:a,namespaceURI:c,value:s}=i,u=ce(a);let l="value"===a?s:R(s);if(r.attrName=u,r.attrValue=l,r.keepAttr=!0,r.forceKeepAttr=void 0,we(it.uponSanitizeAttribute,t,r),l=r.attrValue,!Gt||"id"!==u&&"name"!==u||(ve(a,t),l="user-content-"+l),Lt&&B(/((--!?|])>)|<\/(style|title)/i,l)){ve(a,t);continue}if(r.forceKeepAttr)continue;if(ve(a,t),!r.keepAttr)continue;if(!jt&&B(/\/>/i,l)){ve(a,t);continue}At&&P([at,ct,st],(t=>{l=F(l,t," ")}));const f=ce(t.nodeName);if(Ee(f,u,l)){if(k&&"object"==typeof d&&"function"==typeof d.getAttributeType)if(c);else switch(d.getAttributeType(f,u)){case"TrustedHTML":l=k.createHTML(l);break;case"TrustedScriptURL":l=k.createScriptURL(l)}try{c?t.setAttributeNS(c,a,l):t.setAttribute(a,l),ge(t)?de(t):j(n.removed)}catch(t){}}}we(it.afterSanitizeAttributes,t,null)},Oe=function t(e){let n=null;const r=me(e);for(we(it.beforeSanitizeShadowDOM,e,null);n=r.nextNode();)we(it.uponSanitizeShadowNode,n,null),xe(n),Se(n),n.content instanceof a&&t(n.content);we(it.afterSanitizeShadowDOM,e,null)};return n.sanitize=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=null,i=null,c=null,u=null;if(Qt=!t,Qt&&(t="\x3c!--\x3e"),"string"!=typeof t&&!be(t)){if("function"!=typeof t.toString)throw z("toString is not a function");if("string"!=typeof(t=t.toString()))throw z("dirty is not a string, aborting")}if(!n.isSupported)return t;if(Ct||fe(e),n.removed=[],"string"==typeof t&&(zt=!1),zt){if(t.nodeName){const e=ce(t.nodeName);if(!bt[e]||St[e])throw z("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof s)r=ye("\x3c!----\x3e"),i=r.ownerDocument.importNode(t,!0),1===i.nodeType&&"BODY"===i.nodeName||"HTML"===i.nodeName?r=i:r.appendChild(i);else{if(!Mt&&!At&&!Nt&&-1===t.indexOf("<"))return k&&Dt?k.createHTML(t):t;if(r=ye(t),!r)return Mt?null:Dt?O:""}r&&It&&de(r.firstChild);const l=me(zt?t:r);for(;c=l.nextNode();)xe(c),Se(c),c.content instanceof a&&Oe(c.content);if(zt)return t;if(Mt){if(Ft)for(u=U.call(r.ownerDocument);r.firstChild;)u.appendChild(r.firstChild);else u=r;return(xt.shadowroot||xt.shadowrootmode)&&(u=W.call(o,u,!0)),u}let f=Nt?r.outerHTML:r.innerHTML;return Nt&&bt["!doctype"]&&r.ownerDocument&&r.ownerDocument.doctype&&r.ownerDocument.doctype.name&&B(pt,r.ownerDocument.doctype.name)&&(f="<!DOCTYPE "+r.ownerDocument.doctype.name+">\n"+f),At&&P([at,ct,st],(t=>{f=F(f,t," ")})),k&&Dt?k.createHTML(f):f},n.setConfig=function(){fe(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Ct=!0},n.clearConfig=function(){se=null,Ct=!1},n.isValidAttribute=function(t,e,n){se||fe({});const r=ce(t),o=ce(e);return Ee(r,o,n)},n.addHook=function(t,e){"function"==typeof e&&A(it[t],e)},n.removeHook=function(t,e){if(void 0!==e){const n=_(it[t],e);return-1===n?void 0:N(it[t],n,1)[0]}return j(it[t])},n.removeHooks=function(t){it[t]=[]},n.removeAllHooks=function(){it={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}},n}();function gt(t){return gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gt(t)}function bt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,wt(r.key),r)}}function wt(t){var e=function(t){if("object"!=gt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=gt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==gt(e)?e:e+""}const xt=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.story=e}return e=t,r=[{key:"renderSkeleton",value:function(){return'\n      <article class="story-card skeleton">\n        <div class="story-image skeleton-box"></div>\n        <div class="story-content">\n          <div class="skeleton-text skeleton-box"></div>\n          <div class="skeleton-text skeleton-box"></div>\n          <div class="skeleton-text skeleton-box"></div>\n        </div>\n      </article>\n    '}},{key:"attachEventListeners",value:function(){document.querySelectorAll("[data-route]").forEach((function(e){e.removeEventListener("click",t.handleClick),e.addEventListener("click",t.handleClick)}))}},{key:"handleClick",value:function(t){t.preventDefault();var e=t.currentTarget.getAttribute("data-route");e&&(console.log("Navigating to:",e),window.history.pushState({},"",e),window.dispatchEvent(new PopStateEvent("popstate")))}}],(n=[{key:"render",value:function(){var t=this.story,e=t.id,n=t.name,r=t.description,o=t.photoUrl,i=t.createdAt,a=new Date(i).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric"});return'\n      <article class="story-card" data-story-id="'.concat(e,'">\n        <div class="story-image">\n          <img src="').concat(o,'" alt="Story by ').concat(n,'" loading="lazy">\n        </div>\n        <div class="story-content">\n          <h3 class="story-author">').concat(mt.sanitize(n),'</h3>\n          <p class="story-description">').concat(mt.sanitize(r),'</p>\n          <div class="story-meta">\n            <time datetime="').concat(i,'" class="story-date">\n              <i class="far fa-calendar" aria-hidden="true"></i>\n              ').concat(a,'\n            </time>\n            <a href="/story/').concat(e,'" \n               class="story-link" \n               data-route="/story/').concat(e,'"\n               aria-label="Read full story by ').concat(n,'">\n              Read More <i class="fas fa-arrow-right" aria-hidden="true"></i>\n            </a>\n          </div>\n        </div>\n      </article>\n    ')}}])&&bt(e.prototype,n),r&&bt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,r}();var Et="https://story-api.dicoding.dev/v1",kt="/register",St="/login",Ot="/stories",Tt="/stories/guest",Pt="/notifications/subscribe",_t="/notifications/subscribe";function jt(t){return jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jt(t)}function At(){At=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function s(t,e,n,r){return Object.defineProperty(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function u(e,n,r,o){var i=n&&n.prototype instanceof h?n:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=x(c,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(e,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(e,r,new S(o||[])),!0),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var f={};function h(){}function p(){}function d(){}var v={};s(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(O([])));m&&m!==n&&r.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function n(o,i,a,c){var s=l(t[o],t,i);if("throw"!==s.type){var u=s.arg,f=u.value;return f&&"object"==jt(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(f).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var o;s(this,"_invoke",(function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,n){var r=n.method,o=e.i[r];if(o===t)return n.delegate=null,"throw"===r&&e.i.return&&(n.method="return",n.arg=t,x(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var i=l(o,e.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,f;var a=i.arg;return a?a.done?(n[e.r]=a.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,f):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,f)}function E(t){this.tryEntries.push(t)}function k(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function S(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function O(e){if(null!=e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(jt(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,c,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),s(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),s(g,c,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}},e.values=O,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t){a.type="throw",a.arg=e,n.next=t}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],c=this.prev,s=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!s&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=c){if(c<s)return this.method="next",this.arg=t,r(s),!0;if(c<u)return r(u),!1}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[2]===t)return this.complete(n[4],n[3]),k(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]===t){var r=n[4];if("throw"===r.type){var o=r.arg;k(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={i:O(e),r:n,n:r},"next"===this.method&&(this.arg=t),f}},e}function Lt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Nt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Lt(Object(n),!0).forEach((function(e){Ct(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Lt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Ct(t,e,n){return(e=Ft(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function It(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function Mt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ft(r.key),r)}}function Ft(t){var e=function(t){if("object"!=jt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=jt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==jt(e)?e:e+""}var Dt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"request",value:(n=At().mark((function t(e){var n,r,o,i,a,c=arguments;return At().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=c.length>1&&void 0!==c[1]?c[1]:{},r=Kt.getToken(),o=Nt({},n.headers),r&&!n.skipAuth&&(o.Authorization="Bearer ".concat(r)),t.next=6,fetch("".concat(Et).concat(e),Nt(Nt({},n),{},{headers:o}));case 6:return i=t.sent,t.next=9,i.json();case 9:if(a=t.sent,i.ok){t.next=12;break}throw new Error(a.message||"Something went wrong");case 12:return t.abrupt("return",a);case 13:case"end":return t.stop()}}),t)})),r=function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(t){It(i,r,o,a,c,"next",t)}function c(t){It(i,r,o,a,c,"throw",t)}a(void 0)}))},function(t){return r.apply(this,arguments)})},{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request(t,Nt({method:"GET"},e))}},{key:"post",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request(t,{method:"POST",headers:Nt({"Content-Type":"application/json"},n),body:JSON.stringify(e)})}},{key:"postFormData",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request(t,Nt({method:"POST",body:e},n))}},{key:"delete",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n={method:"DELETE",headers:Nt({"Content-Type":"application/json"},arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})};return e&&(n.body=JSON.stringify(e)),this.request(t,n)}}],e&&Mt(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();const Rt=Dt;function Gt(t){return Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gt(t)}function Bt(){Bt=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function s(t,e,n,r){return Object.defineProperty(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function u(e,n,r,o){var i=n&&n.prototype instanceof h?n:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=x(c,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(e,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(e,r,new S(o||[])),!0),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var f={};function h(){}function p(){}function d(){}var v={};s(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(O([])));m&&m!==n&&r.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function n(o,i,a,c){var s=l(t[o],t,i);if("throw"!==s.type){var u=s.arg,f=u.value;return f&&"object"==Gt(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(f).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var o;s(this,"_invoke",(function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,n){var r=n.method,o=e.i[r];if(o===t)return n.delegate=null,"throw"===r&&e.i.return&&(n.method="return",n.arg=t,x(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var i=l(o,e.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,f;var a=i.arg;return a?a.done?(n[e.r]=a.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,f):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,f)}function E(t){this.tryEntries.push(t)}function k(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function S(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function O(e){if(null!=e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(Gt(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,c,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),s(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),s(g,c,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}},e.values=O,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t){a.type="throw",a.arg=e,n.next=t}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],c=this.prev,s=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!s&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=c){if(c<s)return this.method="next",this.arg=t,r(s),!0;if(c<u)return r(u),!1}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[2]===t)return this.complete(n[4],n[3]),k(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]===t){var r=n[4];if("throw"===r.type){var o=r.arg;k(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={i:O(e),r:n,n:r},"next"===this.method&&(this.arg=t),f}},e}function zt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ut(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?zt(Object(n),!0).forEach((function(e){Ht(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):zt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Ht(t,e,n){return(e=Vt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qt(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function Wt(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){qt(i,r,o,a,c,"next",t)}function c(t){qt(i,r,o,a,c,"throw",t)}a(void 0)}))}}function Yt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Vt(r.key),r)}}function Vt(t){var e=function(t){if("object"!=Gt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Gt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Gt(e)?e:e+""}const Kt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"register",value:(r=Wt(Bt().mark((function t(e){var n;return Bt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log("Attempting registration with:",Ut(Ut({},e),{},{password:"[HIDDEN]"})),t.next=4,Rt.post(kt,e);case 4:return n=t.sent,console.log("Registration response:",n),t.abrupt("return",n);case 9:throw t.prev=9,t.t0=t.catch(0),console.error("Registration error:",t.t0),t.t0;case 13:case"end":return t.stop()}}),t,null,[[0,9]])}))),function(t){return r.apply(this,arguments)})},{key:"login",value:(n=Wt(Bt().mark((function t(e){var n;return Bt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log("Attempting login with:",Ut(Ut({},e),{},{password:"[HIDDEN]"})),console.log("Login endpoint:","".concat(Et).concat(St)),t.next=5,Rt.post(St,e);case 5:return n=t.sent,console.log("Login response:",n),n.loginResult?(console.log("Saving token and user data..."),this.saveToken(n.loginResult.token),this.saveUserData(n.loginResult),console.log("Login successful!")):console.error("No loginResult in response"),t.abrupt("return",n);case 11:throw t.prev=11,t.t0=t.catch(0),console.error("Login error:",t.t0),t.t0;case 15:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(t){return n.apply(this,arguments)})},{key:"saveToken",value:function(t){console.log("Saving token to localStorage"),localStorage.setItem("token",t)}},{key:"getToken",value:function(){var t=localStorage.getItem("token");return console.log("Retrieved token:",t?"[TOKEN EXISTS]":"NO TOKEN"),t}},{key:"saveUserData",value:function(t){console.log("Saving user data:",t),localStorage.setItem("userData",JSON.stringify(t))}},{key:"getUserData",value:function(){var t=localStorage.getItem("userData"),e=t?JSON.parse(t):null;return console.log("Retrieved user data:",e),e}},{key:"logout",value:function(){console.log("Logging out..."),localStorage.removeItem("token"),localStorage.removeItem("userData"),window.dispatchEvent(new CustomEvent("auth-changed"))}},{key:"isAuthenticated",value:function(){var t=!!this.getToken();return console.log("Is authenticated:",t),t}}],e&&Yt(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function Jt(t){return Jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jt(t)}function Xt(){Xt=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function s(t,e,n,r){return Object.defineProperty(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function u(e,n,r,o){var i=n&&n.prototype instanceof h?n:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=x(c,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(e,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(e,r,new S(o||[])),!0),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var f={};function h(){}function p(){}function d(){}var v={};s(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(O([])));m&&m!==n&&r.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function n(o,i,a,c){var s=l(t[o],t,i);if("throw"!==s.type){var u=s.arg,f=u.value;return f&&"object"==Jt(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(f).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var o;s(this,"_invoke",(function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,n){var r=n.method,o=e.i[r];if(o===t)return n.delegate=null,"throw"===r&&e.i.return&&(n.method="return",n.arg=t,x(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var i=l(o,e.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,f;var a=i.arg;return a?a.done?(n[e.r]=a.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,f):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,f)}function E(t){this.tryEntries.push(t)}function k(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function S(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function O(e){if(null!=e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(Jt(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,c,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),s(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),s(g,c,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}},e.values=O,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t){a.type="throw",a.arg=e,n.next=t}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],c=this.prev,s=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!s&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=c){if(c<s)return this.method="next",this.arg=t,r(s),!0;if(c<u)return r(u),!1}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[2]===t)return this.complete(n[4],n[3]),k(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]===t){var r=n[4];if("throw"===r.type){var o=r.arg;k(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={i:O(e),r:n,n:r},"next"===this.method&&(this.arg=t),f}},e}function $t(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function Zt(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){$t(i,r,o,a,c,"next",t)}function c(t){$t(i,r,o,a,c,"throw",t)}a(void 0)}))}}function Qt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,te(r.key),r)}}function te(t){var e=function(t){if("object"!=Jt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Jt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Jt(e)?e:e+""}const ee=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"register",value:(r=Zt(Xt().mark((function t(e,n,r){var o,i;return Xt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,o={name:e,email:n,password:r},t.next=4,Kt.register(o);case 4:return i=t.sent,t.abrupt("return",i);case 8:throw t.prev=8,t.t0=t.catch(0),t.t0;case 11:case"end":return t.stop()}}),t,null,[[0,8]])}))),function(t,e,n){return r.apply(this,arguments)})},{key:"login",value:(n=Zt(Xt().mark((function t(e,n){var r,o;return Xt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log("AuthService.login called with:",e),r={email:e,password:n},t.next=5,Kt.login(r);case 5:return o=t.sent,console.log("AuthService.login response:",o),Kt.saveToken(o.loginResult.token),Kt.saveUserData(o.loginResult),window.dispatchEvent(new CustomEvent("auth-changed")),t.abrupt("return",o);case 13:throw t.prev=13,t.t0=t.catch(0),console.error("AuthService.login error:",t.t0),t.t0;case 17:case"end":return t.stop()}}),t,null,[[0,13]])}))),function(t,e){return n.apply(this,arguments)})},{key:"logout",value:function(){console.log("AuthService.logout called"),Kt.logout(),window.dispatchEvent(new CustomEvent("auth-changed"))}},{key:"isAuthenticated",value:function(){var t=Kt.isAuthenticated();return console.log("AuthService.isAuthenticated:",t),t}},{key:"getToken",value:function(){return Kt.getToken()}},{key:"getUserData",value:function(){return Kt.getUserData()}},{key:"getCurrentUser",value:function(){return Kt.getUserData()}}],e&&Qt(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function ne(t){return ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ne(t)}function re(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,oe(r.key),r)}}function oe(t){var e=function(t){if("object"!=ne(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ne(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ne(e)?e:e+""}const ie=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"render",value:function(){return'\n      <section class="home-page">\n        <header class="page-header">\n          <h1>Dicoding Story Sharing</h1>\n          <p>Bagikan momen mu bersama komunitas Dicoding!!</p>\n        </header>\n        \n        <div class="stories-map-container">\n          <div id="stories-map" class="stories-map" role="application" aria-label="Stories location map"></div>\n        </div>\n        \n        <div class="stories-list" id="stories-list" role="feed" aria-busy="true">\n          '.concat(this.renderLoadingSkeletons(),"\n        </div>\n        \n        ").concat(ee.isAuthenticated()?'\n          <div class="load-more-container">\n            <button id="load-more" class="btn btn-secondary" aria-label="Load more stories">\n              Load More Stories\n            </button>\n          </div>\n        ':'\n          <div class="auth-prompt">\n            <p>Please <a href="/login" data-route="/login">login</a> or <a href="/register" data-route="/register">register</a> to view and share stories</p>\n          </div>\n        ',"\n      </section>\n    ")}},{key:"renderSkeletons",value:function(){var t=document.getElementById("stories-list");t&&(t.innerHTML=this.renderLoadingSkeletons(),t.setAttribute("aria-busy","true"))}},{key:"renderLoadingSkeletons",value:function(){return Array(6).fill("").map((function(){return xt.renderSkeleton()})).join("")}},{key:"displayStories",value:function(t){var e=document.getElementById("stories-list");e&&(e.setAttribute("aria-busy","false"),ee.isAuthenticated()?t&&0!==t.length?(e.innerHTML=t.map((function(t){return new xt(t).render()})).join(""),this.attachStoryCardListeners()):e.innerHTML='\n        <div class="no-stories">\n          <i class="fas fa-inbox fa-3x" aria-hidden="true"></i>\n          <p>No stories yet. Be the first to share!</p>\n          <a href="/add" data-route="/add" class="btn btn-primary">Add Story</a>\n        </div>\n      ':e.innerHTML='\n        <div class="no-stories">\n          <i class="fas fa-lock fa-3x" aria-hidden="true"></i>\n          <p>Please login to view stories</p>\n          <div class="auth-actions">\n            <a href="/login" data-route="/login" class="btn btn-primary">Login</a>\n            <a href="/register" data-route="/register" class="btn btn-secondary">Register</a>\n          </div>\n        </div>\n      ')}},{key:"appendStories",value:function(t){var e=document.getElementById("stories-list");if(e&&t){var n=t.map((function(t){return new xt(t).render()})).join("");e.insertAdjacentHTML("beforeend",n),this.attachStoryCardListeners()}}},{key:"attachStoryCardListeners",value:function(){xt.attachEventListeners(),document.querySelectorAll("[data-route]").forEach((function(t){t.hasAttribute("data-listener-attached")||(t.addEventListener("click",(function(t){t.preventDefault();var e=t.currentTarget.getAttribute("data-route");e&&(console.log("Navigating to:",e),window.history.pushState({},"",e),window.dispatchEvent(new PopStateEvent("popstate")))})),t.setAttribute("data-listener-attached","true"))}))}},{key:"showError",value:function(t){var e=document.getElementById("stories-list");e&&(e.setAttribute("aria-busy","false"),e.innerHTML='\n      <div class="error-message" role="alert">\n        <i class="fas fa-exclamation-circle" aria-hidden="true"></i>\n        <p>'.concat(t,'</p>\n        <button onclick="location.reload()" class="btn btn-secondary">Try Again</button>\n      </div>\n    '))}},{key:"showLoadMoreButton",value:function(t){var e=document.getElementById("load-more");e&&(e.style.display=t?"block":"none")}},{key:"setLoadingState",value:function(t){var e=document.getElementById("load-more");e&&(e.disabled=t,e.innerHTML=t?'<i class="fas fa-spinner fa-spin"></i> Loading...':"Load More Stories")}}],e&&re(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function ae(t){return ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ae(t)}function ce(){ce=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function s(t,e,n,r){return Object.defineProperty(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function u(e,n,r,o){var i=n&&n.prototype instanceof h?n:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=x(c,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(e,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(e,r,new S(o||[])),!0),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var f={};function h(){}function p(){}function d(){}var v={};s(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(O([])));m&&m!==n&&r.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function n(o,i,a,c){var s=l(t[o],t,i);if("throw"!==s.type){var u=s.arg,f=u.value;return f&&"object"==ae(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(f).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var o;s(this,"_invoke",(function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,n){var r=n.method,o=e.i[r];if(o===t)return n.delegate=null,"throw"===r&&e.i.return&&(n.method="return",n.arg=t,x(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var i=l(o,e.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,f;var a=i.arg;return a?a.done?(n[e.r]=a.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,f):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,f)}function E(t){this.tryEntries.push(t)}function k(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function S(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function O(e){if(null!=e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(ae(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,c,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),s(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),s(g,c,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}},e.values=O,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t){a.type="throw",a.arg=e,n.next=t}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],c=this.prev,s=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!s&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=c){if(c<s)return this.method="next",this.arg=t,r(s),!0;if(c<u)return r(u),!1}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[2]===t)return this.complete(n[4],n[3]),k(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]===t){var r=n[4];if("throw"===r.type){var o=r.arg;k(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={i:O(e),r:n,n:r},"next"===this.method&&(this.arg=t),f}},e}function se(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function ue(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){se(i,r,o,a,c,"next",t)}function c(t){se(i,r,o,a,c,"throw",t)}a(void 0)}))}}function le(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,fe(r.key),r)}}function fe(t){var e=function(t){if("object"!=ae(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ae(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ae(e)?e:e+""}var he=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"getStories",value:(a=ue(ce().mark((function t(){var e,n,r,o,i,a,c,s,u,l,f,h,p,d=arguments;return ce().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=d.length>0&&void 0!==d[0]?d[0]:{},t.prev=1,r=Ot,o=new URLSearchParams,e.page&&o.append("page",e.page),e.size&&o.append("size",e.size),e.location&&o.append("location",e.location),i=o.toString(),a=i?"".concat(r,"?").concat(i):r,c="".concat(Et).concat(a),console.log("Fetching stories from:",c),s=localStorage.getItem("token"),u={"Content-Type":"application/json"},s?(u.Authorization="Bearer ".concat(s),console.log("Using authentication token")):console.log("No token found, trying without authentication"),t.next=16,fetch(c,{method:"GET",headers:u});case 16:if(l=t.sent,console.log("Stories response status:",l.status),l.ok){t.next=34;break}if(401!==l.status||!e.location){t.next=22;break}return console.log("401 with location parameter, trying without location..."),t.abrupt("return",this.getStories({page:e.page,size:e.size}));case 22:if(401!==l.status||!s){t.next=33;break}return console.log("401 with auth, trying without authentication..."),t.next=26,fetch("".concat(Et).concat(Ot),{method:"GET",headers:{"Content-Type":"application/json"}});case 26:if(!(f=t.sent).ok){t.next=33;break}return t.next=30,f.json();case 30:return h=t.sent,console.log("Success without auth:",h),t.abrupt("return",h);case 33:throw new Error("HTTP ".concat(l.status,": ").concat(l.statusText));case 34:return t.next=36,l.json();case 36:return p=t.sent,console.log("Stories data received:",p),console.log("Number of stories:",(null===(n=p.listStory)||void 0===n?void 0:n.length)||0),t.abrupt("return",p);case 42:throw t.prev=42,t.t0=t.catch(1),console.error("Error fetching stories:",t.t0),t.t0;case 46:case"end":return t.stop()}}),t,this,[[1,42]])}))),function(){return a.apply(this,arguments)})},{key:"getStoryDetail",value:(i=ue(ce().mark((function t(e){var n,r,o,i,a;return ce().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n="".concat(Et).concat(Ot,"/").concat(e),console.log("Fetching story detail from:",n),r=localStorage.getItem("token"),o={"Content-Type":"application/json"},r&&(o.Authorization="Bearer ".concat(r)),t.next=8,fetch(n,{method:"GET",headers:o});case 8:if(i=t.sent,console.log("Story detail response status:",i.status),i.ok){t.next=12;break}throw new Error("HTTP ".concat(i.status,": ").concat(i.statusText));case 12:return t.next=14,i.json();case 14:return a=t.sent,console.log("Story detail data:",a),t.abrupt("return",a);case 19:throw t.prev=19,t.t0=t.catch(0),console.error("Error fetching story detail:",t.t0),t.t0;case 23:case"end":return t.stop()}}),t,null,[[0,19]])}))),function(t){return i.apply(this,arguments)})},{key:"getStoryById",value:(o=ue(ce().mark((function t(e){return ce().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.getStoryDetail(e));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"addStory",value:(r=ue(ce().mark((function t(e){var n,r,o,i;return ce().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=localStorage.getItem("token")){t.next=4;break}throw new Error("Authentication required to add stories");case 4:return(r=new FormData).append("description",e.description),r.append("photo",e.photo),e.lat&&r.append("lat",e.lat),e.lon&&r.append("lon",e.lon),t.next=11,fetch("".concat(Et).concat(Ot),{method:"POST",headers:{Authorization:"Bearer ".concat(n)},body:r});case 11:if((o=t.sent).ok){t.next=14;break}throw new Error("HTTP ".concat(o.status,": ").concat(o.statusText));case 14:return t.next=16,o.json();case 16:return i=t.sent,t.abrupt("return",i);case 20:throw t.prev=20,t.t0=t.catch(0),console.error("Error adding story:",t.t0),t.t0;case 24:case"end":return t.stop()}}),t,null,[[0,20]])}))),function(t){return r.apply(this,arguments)})},{key:"addStoryAsGuest",value:(n=ue(ce().mark((function t(e){var n,r,o;return ce().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(n=new FormData).append("description",e.description),n.append("photo",e.photo),e.lat&&n.append("lat",e.lat),e.lon&&n.append("lon",e.lon),t.next=8,fetch("".concat(Et).concat(Tt),{method:"POST",body:n});case 8:if((r=t.sent).ok){t.next=11;break}throw new Error("HTTP ".concat(r.status,": ").concat(r.statusText));case 11:return t.next=13,r.json();case 13:return o=t.sent,t.abrupt("return",o);case 17:throw t.prev=17,t.t0=t.catch(0),console.error("Error adding guest story:",t.t0),t.t0;case 21:case"end":return t.stop()}}),t,null,[[0,17]])}))),function(t){return n.apply(this,arguments)})}],e&&le(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o,i,a}();const pe=he;function de(t){return de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},de(t)}function ve(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ye(t,e,n){return(e=ge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function me(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ge(r.key),r)}}function ge(t){var e=function(t){if("object"!=de(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=de(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==de(e)?e:e+""}var be=function(){return t=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.containerId=e,this.options=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ve(Object(n),!0).forEach((function(e){ye(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ve(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({center:n.center||[0,0],zoom:n.zoom||10},n),this.map=null,this.markers=[],this.clickMarker=null},e=[{key:"init",value:function(){try{var t=document.getElementById(this.containerId);if(!t)throw new Error("Map container with ID '".concat(this.containerId,"' not found"));return t._leaflet_id&&(console.log("Map container already initialized, cleaning up..."),this.cleanup()),t.innerHTML="",t.removeAttribute("data-leaflet-id"),t._leaflet_id&&delete t._leaflet_id,this.map=L.map(this.containerId).setView(this.options.center,this.options.zoom),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:" OpenStreetMap contributors"}).addTo(this.map),console.log(" Map initialized successfully for container: ".concat(this.containerId)),this.map}catch(t){throw console.error(" Error initializing map for ".concat(this.containerId,":"),t),t}}},{key:"addMarker",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!this.map)return console.warn(" Map not initialized, cannot add marker"),null;try{var r=L.marker([t,e]).addTo(this.map);return n&&r.bindPopup(n),this.markers.push(r),r}catch(t){return console.error(" Error adding marker:",t),null}}},{key:"removeMarker",value:function(t){if(this.map&&t)try{this.map.removeLayer(t);var e=this.markers.indexOf(t);e>-1&&this.markers.splice(e,1)}catch(t){console.error(" Error removing marker:",t)}}},{key:"clearMarkers",value:function(){var t=this;if(this.map)try{this.markers.forEach((function(e){t.map.removeLayer(e)})),this.markers=[],this.clickMarker&&(this.map.removeLayer(this.clickMarker),this.clickMarker=null),console.log(" All markers cleared")}catch(t){console.error(" Error clearing markers:",t)}}},{key:"setView",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this.map)try{var r=null!==n?n:this.map.getZoom();this.map.setView([t,e],r)}catch(t){console.error(" Error setting map view:",t)}else console.warn(" Map not initialized, cannot set view")}},{key:"enableClickToGetLocation",value:function(t){var e=this;if(this.map)try{this.map.on("click",(function(n){var r=n.latlng,o=r.lat,i=r.lng;console.log(" Map clicked at:",o,i),e.clickMarker&&e.map.removeLayer(e.clickMarker),e.clickMarker=L.marker([o,i]).addTo(e.map).bindPopup(" Selected location").openPopup(),t&&"function"==typeof t&&t(o,i)})),console.log(" Click-to-get-location enabled")}catch(t){console.error(" Error enabling click-to-get-location:",t)}else console.error(" Map not initialized, cannot enable click-to-get-location")}},{key:"disableClickToGetLocation",value:function(){if(this.map)try{this.map.off("click"),this.clickMarker&&(this.map.removeLayer(this.clickMarker),this.clickMarker=null),console.log(" Click-to-get-location disabled")}catch(t){console.error(" Error disabling click-to-get-location:",t)}else console.warn(" Map not initialized")}},{key:"getClickedLocation",value:function(){if(this.clickMarker){var t=this.clickMarker.getLatLng();return{lat:t.lat,lng:t.lng}}return null}},{key:"cleanup",value:function(){try{this.map&&(console.log(" Cleaning up map..."),this.clearMarkers(),this.map.remove(),this.map=null,this.clickMarker=null);var t=document.getElementById(this.containerId);t&&(t._leaflet_id&&delete t._leaflet_id,t.innerHTML=""),console.log(" Map cleanup completed")}catch(t){console.error(" Error during map cleanup:",t)}}}],n=[{key:"cleanupContainer",value:function(t){try{var e=document.getElementById(t);if(e&&e._leaflet_id){if(window.L&&window.L.DomUtil){var n=e._leaflet_map;n&&n.remove()}delete e._leaflet_id,e.innerHTML="",console.log(" Cleaned up container: ".concat(t))}}catch(e){console.error(" Error cleaning up container ".concat(t,":"),e)}}}],e&&me(t.prototype,e),n&&me(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();const we=be;function xe(t){return xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xe(t)}function Ee(){Ee=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function s(t,e,n,r){return Object.defineProperty(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function u(e,n,r,o){var i=n&&n.prototype instanceof h?n:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=x(c,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(e,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(e,r,new S(o||[])),!0),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var f={};function h(){}function p(){}function d(){}var v={};s(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(O([])));m&&m!==n&&r.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function n(o,i,a,c){var s=l(t[o],t,i);if("throw"!==s.type){var u=s.arg,f=u.value;return f&&"object"==xe(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(f).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var o;s(this,"_invoke",(function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,n){var r=n.method,o=e.i[r];if(o===t)return n.delegate=null,"throw"===r&&e.i.return&&(n.method="return",n.arg=t,x(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var i=l(o,e.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,f;var a=i.arg;return a?a.done?(n[e.r]=a.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,f):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,f)}function E(t){this.tryEntries.push(t)}function k(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function S(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function O(e){if(null!=e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(xe(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,c,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),s(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),s(g,c,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}},e.values=O,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t){a.type="throw",a.arg=e,n.next=t}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],c=this.prev,s=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!s&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=c){if(c<s)return this.method="next",this.arg=t,r(s),!0;if(c<u)return r(u),!1}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[2]===t)return this.complete(n[4],n[3]),k(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]===t){var r=n[4];if("throw"===r.type){var o=r.arg;k(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={i:O(e),r:n,n:r},"next"===this.method&&(this.arg=t),f}},e}function ke(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function Se(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){ke(i,r,o,a,c,"next",t)}function c(t){ke(i,r,o,a,c,"throw",t)}a(void 0)}))}}function Oe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Te(r.key),r)}}function Te(t){var e=function(t){if("object"!=xe(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=xe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==xe(e)?e:e+""}const Pe=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=e,this.currentPage=1,this.pageSize=10,this.isLoading=!1,this.hasMoreStories=!0,this.mapComponent=null,this.pendingMarkers=[]},e=[{key:"init",value:(i=Se(Ee().mark((function t(){return Ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,ee.isAuthenticated()){t.next=5;break}return console.log("User not authenticated, showing login prompt"),this.showLoginPrompt(),t.abrupt("return");case 5:return console.log("User authenticated, loading stories..."),this.view.renderSkeletons(),t.next=9,this.initializeMap();case 9:return t.next=11,this.loadStories();case 11:this.attachEventListeners(),t.next=18;break;case 14:t.prev=14,t.t0=t.catch(0),console.error("Error initializing home page:",t.t0),this.view.showError("Failed to load stories. Please try again later.");case 18:case"end":return t.stop()}}),t,this,[[0,14]])}))),function(){return i.apply(this,arguments)})},{key:"initializeMap",value:(o=Se(Ee().mark((function t(){var e=this;return Ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){setTimeout((function(){try{if(e.mapComponent&&(e.mapComponent.cleanup(),e.mapComponent=null),we.cleanupContainer("stories-map"),!document.getElementById("stories-map"))return console.warn("Map container not found, will retry..."),void setTimeout((function(){try{we.cleanupContainer("stories-map"),e.mapComponent=new we("stories-map",{center:[-6.2,106.816666],zoom:5}),e.mapComponent.init(),console.log(" Map initialized successfully (retry)"),e.addPendingMarkers(),t()}catch(e){console.error(" Error initializing map (retry):",e),t()}}),500);e.mapComponent=new we("stories-map",{center:[-6.2,106.816666],zoom:5}),e.mapComponent.init(),console.log(" Map initialized successfully"),e.addPendingMarkers(),t()}catch(e){console.error(" Error initializing map:",e),we.cleanupContainer("stories-map"),t()}}),300)})));case 1:case"end":return t.stop()}}),t)}))),function(){return o.apply(this,arguments)})},{key:"addPendingMarkers",value:function(){var t=this;this.pendingMarkers.length>0&&this.mapComponent&&(console.log(" Adding ".concat(this.pendingMarkers.length," pending markers...")),this.pendingMarkers.forEach((function(e,n){try{t.mapComponent.addMarker(e.lat,e.lon,e.popup)&&console.log("   Added pending marker ".concat(n+1,": ").concat(e.name))}catch(t){console.error("   Failed to add pending marker ".concat(n+1,":"),t)}})),this.pendingMarkers=[])}},{key:"showLoginPrompt",value:function(){var t=document.getElementById("stories-list");t&&(t.innerHTML='\n        <div class="auth-required" style="text-align: center; padding: 60px 20px; background: white; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin: 20px 0;">\n          <div style="font-size: 4rem; margin-bottom: 20px;"></div>\n          <h2 style="color: #333; margin-bottom: 15px;">Authentication Required</h2>\n          <p style="color: #666; margin-bottom: 30px; line-height: 1.6;">\n            The Dicoding Story API requires you to be logged in to view stories.<br>\n            Please log in or create an account to continue.\n          </p>\n          <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">\n            <a href="/login" data-route="/login" class="btn btn-primary" style="padding: 12px 24px; text-decoration: none; background: #2196F3; color: white; border-radius: 6px; font-weight: 500;">\n               Login\n            </a>\n            <a href="/register" data-route="/register" class="btn btn-secondary" style="padding: 12px 24px; text-decoration: none; background: #666; color: white; border-radius: 6px; font-weight: 500;">\n               Register\n            </a>\n          </div>\n        </div>\n      ',document.querySelectorAll("[data-route]").forEach((function(t){t.addEventListener("click",(function(t){t.preventDefault();var e=t.target.getAttribute("data-route");window.history.pushState({},"",e),window.dispatchEvent(new PopStateEvent("popstate"))}))})))}},{key:"attachEventListeners",value:function(){var t=this,e=document.getElementById("load-more");e&&e.addEventListener("click",(function(){return t.loadMoreStories()}))}},{key:"loadStories",value:(r=Se(Ee().mark((function t(){var e,n,r,o=this;return Ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isLoading){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,this.isLoading=!0,this.view.setLoadingState(!0),console.log(" Fetching stories page ".concat(this.currentPage,"...")),t.next=8,pe.getStories({page:this.currentPage,size:this.pageSize,location:1});case 8:n=t.sent,console.log(" Got response with ".concat((null===(e=n.listStory)||void 0===e?void 0:e.length)||0," stories")),n&&n.listStory?(1===this.currentPage?this.view.displayStories(n.listStory):this.view.appendStories(n.listStory),console.log(" Processing story locations..."),r=0,n.listStory.forEach((function(t,e){if(t.lat&&t.lon){r++;var n={lat:t.lat,lon:t.lon,popup:"<b>".concat(t.name,"</b><br>").concat(t.description.substring(0,50),"..."),name:t.name};if(o.mapComponent&&o.mapComponent.map)try{o.mapComponent.addMarker(n.lat,n.lon,n.popup)?console.log("   Added marker ".concat(e+1,": ").concat(t.name," at ").concat(t.lat,", ").concat(t.lon)):(console.log("   Failed to add marker for ".concat(t.name," - will queue for later")),o.pendingMarkers.push(n))}catch(e){console.error("   Failed to add marker for ".concat(t.name,":"),e),o.pendingMarkers.push(n)}else o.pendingMarkers.push(n),console.log("   Queued marker ".concat(e+1,": ").concat(t.name))}})),console.log(" Total stories with location: ".concat(r," out of ").concat(n.listStory.length)),console.log(" Pending markers: ".concat(this.pendingMarkers.length)),this.hasMoreStories=n.listStory.length===this.pageSize,this.view.showLoadMoreButton(this.hasMoreStories),console.log(" Stories loaded successfully")):(console.log(" No stories in response"),this.view.displayStories([])),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(2),console.error(" Failed to load stories:",t.t0),t.t0.message.includes("401")?(console.log("401 error - token may be expired, showing login prompt"),ee.logout(),this.showLoginPrompt()):this.view.showError("Failed to load stories. Please try again.");case 17:return t.prev=17,this.isLoading=!1,this.view.setLoadingState(!1),t.finish(17);case 21:case"end":return t.stop()}}),t,this,[[2,13,17,21]])}))),function(){return r.apply(this,arguments)})},{key:"loadMoreStories",value:(n=Se(Ee().mark((function t(){return Ee().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.hasMoreStories&&!this.isLoading){t.next=2;break}return t.abrupt("return");case 2:return this.currentPage++,t.next=5,this.loadStories();case 5:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"cleanup",value:function(){this.mapComponent&&(this.mapComponent.cleanup(),this.mapComponent=null),this.pendingMarkers=[]}}],e&&Oe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o,i}();function _e(t){return _e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_e(t)}function je(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ae(r.key),r)}}function Ae(t){var e=function(t){if("object"!=_e(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=_e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==_e(e)?e:e+""}const Le=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},(e=[{key:"render",value:function(){return'\n      <section class="auth-page">\n        <div class="auth-container">\n          <header class="auth-header">\n            <h1>Welcome Back</h1>\n            <p>Login to share your stories</p>\n          </header>\n\n          <form id="login-form" class="auth-form" novalidate>\n            <div class="form-group">\n              <label for="email">Email</label>\n              <input \n                type="email" \n                id="email" \n                name="email" \n                class="form-control"\n                placeholder="Enter your email"\n                required\n                aria-required="true"\n                aria-describedby="email-error"\n                autocomplete="email"\n              >\n              <div id="email-error" class="error-message" role="alert" aria-live="polite"></div>\n            </div>\n\n            <div class="form-group">\n              <label for="password">Password</label>\n              <input \n                type="password" \n                id="password" \n                name="password" \n                class="form-control"\n                placeholder="Enter your password"\n                required\n                aria-required="true"\n                aria-describedby="password-error"\n                autocomplete="current-password"\n                minlength="8"\n              >\n              <div id="password-error" class="error-message" role="alert" aria-live="polite"></div>\n            </div>\n\n            <div id="form-error" class="error-message" role="alert" aria-live="polite"></div>\n\n            <button type="submit" class="btn btn-primary btn-block" id="login-button">\n              Login\n            </button>\n          </form>\n\n          <div class="auth-footer">\n            <p>Don\'t have an account? <a href="/register" data-route="/register">Register here</a></p>\n          </div>\n        </div>\n      </section>\n    '}},{key:"showError",value:function(t,e){var n=document.getElementById(t);n&&(n.textContent=e,n.style.display="block")}},{key:"clearError",value:function(t){var e=document.getElementById(t);e&&(e.textContent="",e.style.display="none")}},{key:"setLoadingState",value:function(t){var e=document.getElementById("login-button"),n=document.getElementById("login-form");e&&(e.disabled=t,e.innerHTML=t?'<i class="fas fa-spinner fa-spin"></i> Logging in...':"Login"),n&&n.setAttribute("aria-busy",t.toString())}}])&&je(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Ne(t){return Ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ne(t)}function Ce(){Ce=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function s(t,e,n,r){return Object.defineProperty(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function u(e,n,r,o){var i=n&&n.prototype instanceof h?n:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=x(c,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(e,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(e,r,new S(o||[])),!0),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var f={};function h(){}function p(){}function d(){}var v={};s(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(O([])));m&&m!==n&&r.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function n(o,i,a,c){var s=l(t[o],t,i);if("throw"!==s.type){var u=s.arg,f=u.value;return f&&"object"==Ne(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(f).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var o;s(this,"_invoke",(function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,n){var r=n.method,o=e.i[r];if(o===t)return n.delegate=null,"throw"===r&&e.i.return&&(n.method="return",n.arg=t,x(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var i=l(o,e.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,f;var a=i.arg;return a?a.done?(n[e.r]=a.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,f):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,f)}function E(t){this.tryEntries.push(t)}function k(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function S(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function O(e){if(null!=e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(Ne(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,c,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),s(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),s(g,c,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}},e.values=O,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t){a.type="throw",a.arg=e,n.next=t}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],c=this.prev,s=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!s&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=c){if(c<s)return this.method="next",this.arg=t,r(s),!0;if(c<u)return r(u),!1}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[2]===t)return this.complete(n[4],n[3]),k(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]===t){var r=n[4];if("throw"===r.type){var o=r.arg;k(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={i:O(e),r:n,n:r},"next"===this.method&&(this.arg=t),f}},e}function Ie(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function Me(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Fe(r.key),r)}}function Fe(t){var e=function(t){if("object"!=Ne(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Ne(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ne(e)?e:e+""}const De=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=e},e=[{key:"init",value:function(){var t=this;document.getElementById("login-form").addEventListener("submit",(function(e){return t.handleSubmit(e)})),this.showDebugInfo(" Login form initialized")}},{key:"handleSubmit",value:(n=Ce().mark((function t(e){var n,r,o,i;return Ce().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),this.showDebugInfo(" Login form submitted"),this.view.clearError("email-error"),this.view.clearError("password-error"),this.view.clearError("form-error"),n=document.getElementById("email").value.trim(),r=document.getElementById("password").value,this.showDebugInfo(" Email: ".concat(n)),this.showDebugInfo(" Password length: ".concat(r.length)),o=!1,n?this.isValidEmail(n)||(this.view.showError("email-error","Please enter a valid email address"),o=!0):(this.view.showError("email-error","Email is required"),o=!0),r?r.length<8&&(this.view.showError("password-error","Password must be at least 8 characters"),o=!0):(this.view.showError("password-error","Password is required"),o=!0),!o){t.next=15;break}return this.showDebugInfo(" Validation failed"),t.abrupt("return");case 15:return this.showDebugInfo(" Validation passed"),t.prev=16,this.view.setLoadingState(!0),this.showDebugInfo(" Calling AuthService.login..."),t.next=21,ee.login(n,r);case 21:i=t.sent,this.showDebugInfo(" Login successful!"),this.showDebugInfo(" Response: ".concat(JSON.stringify(i).substring(0,100),"...")),tr.navigateTo("/"),t.next=31;break;case 27:t.prev=27,t.t0=t.catch(16),this.showDebugInfo(" Login failed: ".concat(t.t0.message)),this.view.showError("form-error",t.t0.message||"Login failed. Please check your credentials.");case 31:return t.prev=31,this.view.setLoadingState(!1),t.finish(31);case 34:case"end":return t.stop()}}),t,this,[[16,27,31,34]])})),r=function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(t){Ie(i,r,o,a,c,"next",t)}function c(t){Ie(i,r,o,a,c,"throw",t)}a(void 0)}))},function(t){return r.apply(this,arguments)})},{key:"isValidEmail",value:function(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)}},{key:"showDebugInfo",value:function(t){var e=document.getElementById("debug-panel");e||((e=document.createElement("div")).id="debug-panel",e.style.cssText="\n        position: fixed;\n        top: 80px;\n        right: 10px;\n        width: 300px;\n        max-height: 400px;\n        background: rgba(0,0,0,0.8);\n        color: white;\n        padding: 10px;\n        border-radius: 8px;\n        font-size: 12px;\n        z-index: 1000;\n        overflow-y: auto;\n        font-family: monospace;\n      ",document.body.appendChild(e));var n=(new Date).toLocaleTimeString(),r=document.createElement("div");for(r.textContent="[".concat(n,"] ").concat(t),e.appendChild(r);e.children.length>20;)e.removeChild(e.firstChild);e.scrollTop=e.scrollHeight}}],e&&Me(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function Re(t){return Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Re(t)}function Ge(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Be(r.key),r)}}function Be(t){var e=function(t){if("object"!=Re(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Re(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Re(e)?e:e+""}const ze=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},(e=[{key:"render",value:function(){return'\n      <section class="auth-page">\n        <div class="auth-container">\n          <header class="auth-header">\n            <h1>Join Dicoding Story</h1>\n            <p>Create an account to start sharing your stories</p>\n          </header>\n\n          <form id="register-form" class="auth-form" novalidate>\n            <div class="form-group">\n              <label for="name">Full Name</label>\n              <input \n                type="text" \n                id="name" \n                name="name" \n                class="form-control"\n                placeholder="Enter your full name"\n                required\n                aria-required="true"\n                aria-describedby="name-error"\n                autocomplete="name"\n              >\n              <div id="name-error" class="error-message" role="alert" aria-live="polite"></div>\n            </div>\n\n            <div class="form-group">\n              <label for="email">Email</label>\n              <input \n                type="email" \n                id="email" \n                name="email" \n                class="form-control"\n                placeholder="Enter your email"\n                required\n                aria-required="true"\n                aria-describedby="email-error"\n                autocomplete="email"\n              >\n              <div id="email-error" class="error-message" role="alert" aria-live="polite"></div>\n            </div>\n\n            <div class="form-group">\n              <label for="password">Password</label>\n              <input \n                type="password" \n                id="password" \n                name="password" \n                class="form-control"\n                placeholder="Enter your password (min. 8 characters)"\n                required\n                aria-required="true"\n                aria-describedby="password-error"\n                autocomplete="new-password"\n                minlength="8"\n              >\n              <div id="password-error" class="error-message" role="alert" aria-live="polite"></div>\n            </div>\n\n            <div id="form-error" class="error-message" role="alert" aria-live="polite"></div>\n\n            <button type="submit" class="btn btn-primary btn-block" id="register-button">\n              Register\n            </button>\n          </form>\n\n          <div class="auth-footer">\n            <p>Already have an account? <a href="/login" data-route="/login">Login here</a></p>\n          </div>\n        </div>\n      </section>\n    '}},{key:"showError",value:function(t,e){var n=document.getElementById(t);n&&(n.textContent=e,n.style.display="block")}},{key:"clearError",value:function(t){var e=document.getElementById(t);e&&(e.textContent="",e.style.display="none")}},{key:"setLoadingState",value:function(t){var e=document.getElementById("register-button"),n=document.getElementById("register-form");e&&(e.disabled=t,e.innerHTML=t?'<i class="fas fa-spinner fa-spin"></i> Creating account...':"Register"),n&&n.setAttribute("aria-busy",t.toString())}},{key:"showSuccess",value:function(t){var e=document.createElement("div");e.className="success-message",e.style.cssText="\n      background: #4CAF50;\n      color: white;\n      padding: 15px;\n      border-radius: 6px;\n      margin: 15px 0;\n      text-align: center;\n    ",e.textContent=t;var n=document.getElementById("register-form");n&&n.parentNode.insertBefore(e,n)}}])&&Ge(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Ue(t){return Ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ue(t)}function He(){He=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function s(t,e,n,r){return Object.defineProperty(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function u(e,n,r,o){var i=n&&n.prototype instanceof h?n:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=x(c,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(e,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(e,r,new S(o||[])),!0),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var f={};function h(){}function p(){}function d(){}var v={};s(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(O([])));m&&m!==n&&r.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function n(o,i,a,c){var s=l(t[o],t,i);if("throw"!==s.type){var u=s.arg,f=u.value;return f&&"object"==Ue(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(f).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var o;s(this,"_invoke",(function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,n){var r=n.method,o=e.i[r];if(o===t)return n.delegate=null,"throw"===r&&e.i.return&&(n.method="return",n.arg=t,x(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var i=l(o,e.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,f;var a=i.arg;return a?a.done?(n[e.r]=a.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,f):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,f)}function E(t){this.tryEntries.push(t)}function k(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function S(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function O(e){if(null!=e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(Ue(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,c,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),s(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),s(g,c,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}},e.values=O,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t){a.type="throw",a.arg=e,n.next=t}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],c=this.prev,s=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!s&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=c){if(c<s)return this.method="next",this.arg=t,r(s),!0;if(c<u)return r(u),!1}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[2]===t)return this.complete(n[4],n[3]),k(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]===t){var r=n[4];if("throw"===r.type){var o=r.arg;k(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={i:O(e),r:n,n:r},"next"===this.method&&(this.arg=t),f}},e}function qe(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function We(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ye(r.key),r)}}function Ye(t){var e=function(t){if("object"!=Ue(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Ue(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ue(e)?e:e+""}const Ve=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=e},e=[{key:"init",value:function(){var t=this,e=document.getElementById("register-form");e?(e.addEventListener("submit",(function(e){return t.handleSubmit(e)})),console.log("Register form initialized")):console.error("Register form not found")}},{key:"handleSubmit",value:(n=He().mark((function t(e){var n,r,o,i,a,c,s,u;return He().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),console.log("Register form submitted"),this.view.clearError("name-error"),this.view.clearError("email-error"),this.view.clearError("password-error"),this.view.clearError("form-error"),n=document.getElementById("name"),r=document.getElementById("email"),o=document.getElementById("password"),n&&r&&o){t.next=13;break}return console.error("Form elements not found"),this.view.showError("form-error","Form elements not found. Please try again."),t.abrupt("return");case 13:if(i=n.value.trim(),a=r.value.trim(),c=o.value,console.log("Registration attempt - Name: ".concat(i,", Email: ").concat(a,", Password length: ").concat(c.length)),s=!1,i||(this.view.showError("name-error","Name is required"),s=!0),a?this.isValidEmail(a)||(this.view.showError("email-error","Please enter a valid email address"),s=!0):(this.view.showError("email-error","Email is required"),s=!0),c?c.length<8&&(this.view.showError("password-error","Password must be at least 8 characters"),s=!0):(this.view.showError("password-error","Password is required"),s=!0),!s){t.next=24;break}return console.log("Validation failed"),t.abrupt("return");case 24:return console.log("Validation passed, attempting registration..."),t.prev=25,this.view.setLoadingState(!0),t.next=29,ee.register(i,a,c);case 29:u=t.sent,console.log("Registration successful:",u),this.view.showSuccess("Registration successful! Please login with your new account."),setTimeout((function(){tr.navigateTo("/login")}),2e3),t.next=39;break;case 35:t.prev=35,t.t0=t.catch(25),console.error("Registration failed:",t.t0),this.view.showError("form-error",t.t0.message||"Registration failed. Please try again.");case 39:return t.prev=39,this.view.setLoadingState(!1),t.finish(39);case 42:case"end":return t.stop()}}),t,this,[[25,35,39,42]])})),r=function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(t){qe(i,r,o,a,c,"next",t)}function c(t){qe(i,r,o,a,c,"throw",t)}a(void 0)}))},function(t){return r.apply(this,arguments)})},{key:"isValidEmail",value:function(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)}}],e&&We(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function Ke(t){return Ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ke(t)}function Je(){Je=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function s(t,e,n,r){return Object.defineProperty(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function u(e,n,r,o){var i=n&&n.prototype instanceof h?n:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=x(c,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(e,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(e,r,new S(o||[])),!0),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var f={};function h(){}function p(){}function d(){}var v={};s(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(O([])));m&&m!==n&&r.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function n(o,i,a,c){var s=l(t[o],t,i);if("throw"!==s.type){var u=s.arg,f=u.value;return f&&"object"==Ke(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(f).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var o;s(this,"_invoke",(function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,n){var r=n.method,o=e.i[r];if(o===t)return n.delegate=null,"throw"===r&&e.i.return&&(n.method="return",n.arg=t,x(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var i=l(o,e.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,f;var a=i.arg;return a?a.done?(n[e.r]=a.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,f):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,f)}function E(t){this.tryEntries.push(t)}function k(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function S(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function O(e){if(null!=e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(Ke(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,c,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),s(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),s(g,c,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}},e.values=O,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t){a.type="throw",a.arg=e,n.next=t}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],c=this.prev,s=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!s&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=c){if(c<s)return this.method="next",this.arg=t,r(s),!0;if(c<u)return r(u),!1}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[2]===t)return this.complete(n[4],n[3]),k(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]===t){var r=n[4];if("throw"===r.type){var o=r.arg;k(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={i:O(e),r:n,n:r},"next"===this.method&&(this.arg=t),f}},e}function Xe(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function $e(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Xe(i,r,o,a,c,"next",t)}function c(t){Xe(i,r,o,a,c,"throw",t)}a(void 0)}))}}function Ze(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Qe(r.key),r)}}function Qe(t){var e=function(t){if("object"!=Ke(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Ke(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ke(e)?e:e+""}const tn=function(){return t=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.videoElement=e,this.canvasElement=n,this.stream=null,this.facingMode="user"},e=[{key:"showCameraUI",value:function(){this.videoElement.style.display="block",document.getElementById("photo-preview").style.display="none",document.getElementById("start-camera").style.display="none",document.getElementById("capture-photo").style.display="inline-block",document.getElementById("switch-camera").style.display="inline-block",document.getElementById("stop-camera").style.display="inline-block",document.getElementById("retake-photo").style.display="none"}},{key:"showPhotoPreview",value:function(t){var e=document.getElementById("photo-preview");e.src=URL.createObjectURL(t),e.style.display="block",this.videoElement.style.display="none",document.getElementById("capture-photo").style.display="none",document.getElementById("switch-camera").style.display="none",document.getElementById("stop-camera").style.display="none",document.getElementById("retake-photo").style.display="inline-block"}},{key:"startCamera",value:(o=$e(Je().mark((function t(){return Je().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,navigator.mediaDevices.getUserMedia({video:{facingMode:this.facingMode},audio:!1});case 3:return this.stream=t.sent,this.videoElement.srcObject=this.stream,this.showCameraUI(),t.abrupt("return",!0);case 9:throw t.prev=9,t.t0=t.catch(0),console.error("Error accessing camera:",t.t0),t.t0;case 13:case"end":return t.stop()}}),t,this,[[0,9]])}))),function(){return o.apply(this,arguments)})},{key:"stopCamera",value:function(){this.stream&&(this.stream.getTracks().forEach((function(t){return t.stop()})),this.stream=null),this.videoElement.srcObject=null,this.videoElement.style.display="none",document.getElementById("start-camera").style.display="inline-block",document.getElementById("capture-photo").style.display="none",document.getElementById("switch-camera").style.display="none",document.getElementById("stop-camera").style.display="none",document.getElementById("retake-photo").style.display="none"}},{key:"capturePhoto",value:(r=$e(Je().mark((function t(){var e,n=this;return Je().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.stream){t.next=2;break}return t.abrupt("return",null);case 2:return e=this.canvasElement.getContext("2d"),this.canvasElement.width=this.videoElement.videoWidth,this.canvasElement.height=this.videoElement.videoHeight,e.drawImage(this.videoElement,0,0,this.canvasElement.width,this.canvasElement.height),t.abrupt("return",new Promise((function(t){n.canvasElement.toBlob((function(e){t(e)}),"image/jpeg",.95)})));case 7:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"switchCamera",value:(n=$e(Je().mark((function t(){return Je().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.facingMode="user"===this.facingMode?"environment":"user",t.next=3,this.stopCamera();case 3:return t.next=5,this.startCamera();case 5:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"handleFileSelect",value:function(t){return new Promise((function(e,n){var r=t.target.files[0];r?r.type.match("image.*")?e(r):n(new Error("Please select an image file")):n(new Error("No file selected"))}))}}],e&&Ze(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o}();function en(t){return en="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},en(t)}function nn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,rn(r.key),r)}}function rn(t){var e=function(t){if("object"!=en(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=en(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==en(e)?e:e+""}const on=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cameraHandler=null,this.mapComponent=null},(e=[{key:"render",value:function(){return'\n      <section class="add-story-page">\n        <header class="page-header">\n          <h1>Bagi Ceritamu</h1>\n          <p>Bagikan momen mu bersama komunitas Dicoding!!</p>\n        </header>\n\n        <form id="add-story-form" class="story-form" novalidate>\n          <div class="form-group">\n            <label for="story-description">Deskripsi Cerita</label>\n            <textarea \n              id="story-description" \n              name="description" \n              class="form-control"\n              rows="4"\n              placeholder="What\'s your story?"\n              required\n              aria-required="true"\n              aria-describedby="description-error"\n            ></textarea>\n            <div id="description-error" class="error-message" role="alert" aria-live="polite"></div>\n          </div>\n\n          <div class="form-group">\n            <label for="story-photo">Foto Cerita</label>\n            <div class="photo-capture-container">\n              <div class="camera-preview">\n                <video id="camera-video" autoplay playsinline></video>\n                <canvas id="camera-canvas" style="display: none;"></canvas>\n                <img id="photo-preview" alt="Photo preview" style="display: none;">\n              </div>\n              \n              <div class="file-upload">\n                <input \n                  type="file" \n                  id="photo-file" \n                  accept="image/*" \n                  class="form-control"\n                  aria-describedby="photo-error"\n                >\n                <div class="btn mt-3">\n                  <label for="photo-file" class="btn btn-secondary">\n                    <i class="fas fa-upload" aria-hidden="true"></i> Upload from device\n                  </label>\n                </div>\n\n                <div class="camera-controls">\n                <button type="button" id="start-camera" class="btn btn-secondary">\n                  <i class="fas fa-camera" aria-hidden="true"></i> Start Camera\n                </button>\n                <button type="button" id="stop-camera" class="btn btn-danger" style="display: none;">\n                  <i class="fas fa-power-off" aria-hidden="true"></i> Turn Off\n                </button>\n                <button type="button" id="capture-photo" class="btn btn-primary" style="display: none;">\n                  <i class="fas fa-camera" aria-hidden="true"></i> Capture\n                </button>\n                <button type="button" id="switch-camera" class="btn btn-secondary" style="display: none;">\n                  <i class="fas fa-sync-alt" aria-hidden="true"></i> Switch\n                </button>\n                <button type="button" id="retake-photo" class="btn btn-secondary" style="display: none;">\n                  <i class="fas fa-redo" aria-hidden="true"></i> Retake\n                </button>\n              </div>\n\n              </div>\n              <div id="photo-error" class="error-message" role="alert" aria-live="polite"></div>\n            </div>\n          </div>\n\n          <div class="form-group">\n            <label>Lokasi (Opsional)</label>\n            <div class="location-container">\n              <div id="location-map" class="location-map" role="application" aria-label="Select story location"></div>\n              <div class="location-controls">\n                <button type="button" id="use-current-location" class="btn btn-secondary">\n                  <i class="fas fa-location-arrow" aria-hidden="true"></i> Use Current Location\n                </button>\n                <p class="location-hint">Click on the map to select location</p>\n              </div>\n              <div class="selected-location" id="selected-location" style="display: none;">\n                <i class="fas fa-map-marker-alt" aria-hidden="true"></i>\n                <span id="location-text"></span>\n                <button type="button" id="clear-location" class="btn-icon" aria-label="Clear location">\n                  <i class="fas fa-times" aria-hidden="true"></i>\n                </button>\n              </div>\n            </div>\n          </div>\n\n          <div class="form-actions">\n            <button type="submit" class="btn btn-primary" id="submit-story">\n              <i class="fas fa-paper-plane" aria-hidden="true"></i> Bagikan\n            </button>\n            <a href="/" data-route="/" class="btn btn-secondary">Cancel</a>\n          </div>\n        </form>\n      </section>\n    '}},{key:"initCamera",value:function(){var t=document.getElementById("camera-video"),e=document.getElementById("camera-canvas");return t&&e?(this.cameraHandler=new tn(t,e),this.cameraHandler):null}},{key:"initMap",value:function(){return document.getElementById("location-map")?(this.mapComponent=new we("location-map",{center:[-6.2,106.816666],zoom:13}),this.mapComponent.init()):null}},{key:"showError",value:function(t,e){var n=document.getElementById(t);n&&(n.textContent=e,n.style.display="block")}},{key:"clearError",value:function(t){var e=document.getElementById(t);e&&(e.textContent="",e.style.display="none")}},{key:"setLoadingState",value:function(t){var e=document.getElementById("submit-story"),n=document.getElementById("add-story-form");e&&(e.disabled=t,e.innerHTML=t?'<i class="fas fa-spinner fa-spin"></i> Sharing...':'<i class="fas fa-paper-plane"></i> Share Story'),n&&n.setAttribute("aria-busy",t.toString())}},{key:"showSuccess",value:function(t){var e=document.createElement("div");e.style.cssText="\n      position: fixed;\n      top: 20px;\n      right: 20px;\n      background: #4CAF50;\n      color: white;\n      padding: 15px 20px;\n      border-radius: 6px;\n      z-index: 1000;\n      box-shadow: 0 4px 8px rgba(0,0,0,0.2);\n    ",e.textContent=t,document.body.appendChild(e),setTimeout((function(){e.parentNode&&e.parentNode.removeChild(e)}),3e3)}}])&&nn(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function an(t){return an="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},an(t)}function cn(){cn=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function s(t,e,n,r){return Object.defineProperty(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function u(e,n,r,o){var i=n&&n.prototype instanceof h?n:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=x(c,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(e,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(e,r,new S(o||[])),!0),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var f={};function h(){}function p(){}function d(){}var v={};s(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(O([])));m&&m!==n&&r.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function n(o,i,a,c){var s=l(t[o],t,i);if("throw"!==s.type){var u=s.arg,f=u.value;return f&&"object"==an(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(f).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var o;s(this,"_invoke",(function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,n){var r=n.method,o=e.i[r];if(o===t)return n.delegate=null,"throw"===r&&e.i.return&&(n.method="return",n.arg=t,x(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var i=l(o,e.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,f;var a=i.arg;return a?a.done?(n[e.r]=a.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,f):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,f)}function E(t){this.tryEntries.push(t)}function k(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function S(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function O(e){if(null!=e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(an(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,c,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),s(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),s(g,c,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}},e.values=O,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t){a.type="throw",a.arg=e,n.next=t}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],c=this.prev,s=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!s&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=c){if(c<s)return this.method="next",this.arg=t,r(s),!0;if(c<u)return r(u),!1}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[2]===t)return this.complete(n[4],n[3]),k(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]===t){var r=n[4];if("throw"===r.type){var o=r.arg;k(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={i:O(e),r:n,n:r},"next"===this.method&&(this.arg=t),f}},e}function sn(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function un(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){sn(i,r,o,a,c,"next",t)}function c(t){sn(i,r,o,a,c,"throw",t)}a(void 0)}))}}function ln(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,fn(r.key),r)}}function fn(t){var e=function(t){if("object"!=an(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=an(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==an(e)?e:e+""}const hn=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=e,this.photoBlob=null,this.selectedLocation=null},e=[{key:"init",value:(s=un(cn().mark((function t(){return cn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.view.initCamera(),this.view.initMap(),this.attachEventListeners();case 3:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)})},{key:"attachEventListeners",value:function(){var t=this,e=document.getElementById("add-story-form"),n=document.getElementById("start-camera"),r=document.getElementById("capture-photo"),o=document.getElementById("switch-camera"),i=document.getElementById("stop-camera"),a=document.getElementById("retake-photo"),c=document.getElementById("photo-file"),s=document.getElementById("use-current-location"),u=document.getElementById("clear-location");e.addEventListener("submit",(function(e){return t.handleSubmit(e)})),n.addEventListener("click",(function(){return t.startCamera()})),r.addEventListener("click",(function(){return t.capturePhoto()})),o.addEventListener("click",(function(){return t.switchCamera()})),i.addEventListener("click",(function(){return t.stopCamera()})),a.addEventListener("click",(function(){return t.retakePhoto()})),c.addEventListener("change",(function(e){return t.handleFileSelect(e)})),s.addEventListener("click",(function(){return t.useCurrentLocation()})),u&&u.addEventListener("click",(function(){return t.clearLocation()})),this.view.mapComponent.enableClickToGetLocation((function(e,n){t.setLocation(e,n)}))}},{key:"startCamera",value:(c=un(cn().mark((function t(){return cn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.view.cameraHandler.startCamera();case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),this.view.showError("photo-error","Failed to access camera. Please check permissions.");case 8:case"end":return t.stop()}}),t,this,[[0,5]])}))),function(){return c.apply(this,arguments)})},{key:"stopCamera",value:function(){try{this.view.cameraHandler.stopCamera()}catch(t){this.view.showError("photo-error","Failed to stop camera. Please try again.")}}},{key:"capturePhoto",value:(a=un(cn().mark((function t(){return cn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.view.cameraHandler.capturePhoto();case 3:this.photoBlob=t.sent,this.view.cameraHandler.showPhotoPreview(this.photoBlob),this.view.cameraHandler.stopCamera(),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),this.view.showError("photo-error","Failed to capture photo. Please try again.");case 11:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(){return a.apply(this,arguments)})},{key:"switchCamera",value:(i=un(cn().mark((function t(){return cn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.view.cameraHandler.switchCamera();case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),this.view.showError("photo-error","Failed to switch camera.");case 8:case"end":return t.stop()}}),t,this,[[0,5]])}))),function(){return i.apply(this,arguments)})},{key:"retakePhoto",value:function(){this.photoBlob=null,this.startCamera()}},{key:"handleFileSelect",value:(o=un(cn().mark((function t(e){return cn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.view.cameraHandler.handleFileSelect(e);case 3:this.photoBlob=t.sent,this.view.cameraHandler.showPhotoPreview(this.photoBlob),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),this.view.showError("photo-error",t.t0.message);case 10:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(t){return o.apply(this,arguments)})},{key:"useCurrentLocation",value:(r=un(cn().mark((function t(){var e;return cn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.view.mapComponent.getCurrentLocation();case 3:e=t.sent,this.setLocation(e.lat,e.lon),this.view.mapComponent.setView(e.lat,e.lon,15),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),this.view.showError("location-error","Failed to get current location.");case 11:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(){return r.apply(this,arguments)})},{key:"setLocation",value:function(t,e){this.selectedLocation={lat:t,lon:e},this.view.mapComponent.clearMarkers(),this.view.mapComponent.addMarker(t,e,"Selected location");var n=document.getElementById("selected-location"),r=document.getElementById("location-text");n&&r&&(n.style.display="flex",r.textContent="".concat(t.toFixed(6),", ").concat(e.toFixed(6)))}},{key:"clearLocation",value:function(){this.selectedLocation=null,this.view.mapComponent.clearMarkers();var t=document.getElementById("selected-location");t&&(t.style.display="none")}},{key:"handleSubmit",value:(n=un(cn().mark((function t(e){var n,r,o,i;return cn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),this.view.clearError("description-error"),this.view.clearError("photo-error"),n=document.getElementById("story-description").value.trim()){t.next=7;break}return this.view.showError("description-error","Description is required"),t.abrupt("return");case 7:if(this.photoBlob){t.next=10;break}return this.view.showError("photo-error","Photo is required"),t.abrupt("return");case 10:return t.prev=10,this.view.setLoadingState(!0),i={description:n,photo:this.photoBlob,lat:null===(r=this.selectedLocation)||void 0===r?void 0:r.lat,lon:null===(o=this.selectedLocation)||void 0===o?void 0:o.lon},t.next=15,pe.addStory(i);case 15:this.view.showSuccess("Story added successfully!"),this.view.cameraHandler&&this.view.cameraHandler.stopCamera(),setTimeout((function(){tr.navigateTo("/")}),1500),t.next=24;break;case 20:t.prev=20,t.t0=t.catch(10),this.view.showError("form-error","Failed to add story. Please try again."),console.error("Error adding story:",t.t0);case 24:return t.prev=24,this.view.setLoadingState(!1),t.finish(24);case 27:case"end":return t.stop()}}),t,this,[[10,20,24,27]])}))),function(t){return n.apply(this,arguments)})}],e&&ln(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o,i,a,c,s}();function pn(t){return pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pn(t)}function dn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,vn(r.key),r)}}function vn(t){var e=function(t){if("object"!=pn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=pn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==pn(e)?e:e+""}const yn=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.mapComponent=null},(e=[{key:"render",value:function(){return'\n      <section class="detail-story-page">\n        <div class="story-detail-skeleton">\n          <div class="skeleton-image skeleton-box"></div>\n          <div class="skeleton-content">\n            <div class="skeleton-text skeleton-box"></div>\n            <div class="skeleton-text skeleton-box"></div>\n            <div class="skeleton-text skeleton-box"></div>\n          </div>\n        </div>\n      </section>\n    '}},{key:"displayStory",value:function(t){var e=this,n=document.querySelector(".detail-story-page");if(n){var r=new Date(t.createdAt).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});n.innerHTML='\n      <article class="story-detail">\n        <button onclick="history.back()" class="btn btn-back" aria-label="Go back">\n          <i class="fas fa-arrow-left" aria-hidden="true"></i> Back\n        </button>\n        \n        <div class="story-image">\n          <img src="'.concat(t.photoUrl,'" alt="Story by ').concat(t.name,'">\n        </div>\n        \n        <div class="story-content">\n          <header class="story-header">\n            <h1>').concat(mt.sanitize(t.name),'</h1>\n            <time datetime="').concat(t.createdAt,'" class="story-date">\n              <i class="far fa-calendar" aria-hidden="true"></i>\n              ').concat(r,'\n            </time>\n          </header>\n          \n          <div class="story-description">\n            <p>').concat(mt.sanitize(t.description),"</p>\n          </div>\n          \n          ").concat(t.lat&&t.lon?'\n            <div class="story-location">\n              <h2>Location</h2>\n              <div id="story-location-map" class="story-map" role="application" aria-label="Story location map"></div>\n            </div>\n          ':"","\n        </div>\n      </article>\n    "),t.lat&&t.lon&&setTimeout((function(){e.initMap(t.lat,t.lon,t.name)}),100)}}},{key:"initMap",value:function(t,e,n){try{this.mapComponent=new we("story-location-map",{center:[t,e],zoom:15}),this.mapComponent.init(),this.mapComponent.addMarker(t,e,"<b>".concat(n,"</b><br>Story location")),console.log(" Story location map initialized at ".concat(t,", ").concat(e))}catch(t){console.error(" Error initializing story location map:",t)}}},{key:"showError",value:function(t){var e=document.querySelector(".detail-story-page");e&&(e.innerHTML='\n        <div class="error-message" role="alert">\n          <i class="fas fa-exclamation-circle" aria-hidden="true"></i>\n          <p>'.concat(t,'</p>\n          <button onclick="history.back()" class="btn btn-secondary">Go Back</button>\n        </div>\n      '))}}])&&dn(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function mn(t){return mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mn(t)}function gn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function bn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?gn(Object(n),!0).forEach((function(e){wn(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):gn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function wn(t,e,n){return(e=On(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xn(){xn=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function s(t,e,n,r){return Object.defineProperty(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function u(e,n,r,o){var i=n&&n.prototype instanceof h?n:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=x(c,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(e,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(e,r,new S(o||[])),!0),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var f={};function h(){}function p(){}function d(){}var v={};s(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(O([])));m&&m!==n&&r.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function n(o,i,a,c){var s=l(t[o],t,i);if("throw"!==s.type){var u=s.arg,f=u.value;return f&&"object"==mn(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(f).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var o;s(this,"_invoke",(function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,n){var r=n.method,o=e.i[r];if(o===t)return n.delegate=null,"throw"===r&&e.i.return&&(n.method="return",n.arg=t,x(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var i=l(o,e.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,f;var a=i.arg;return a?a.done?(n[e.r]=a.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,f):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,f)}function E(t){this.tryEntries.push(t)}function k(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function S(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function O(e){if(null!=e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(mn(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,c,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),s(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),s(g,c,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}},e.values=O,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t){a.type="throw",a.arg=e,n.next=t}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],c=this.prev,s=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!s&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=c){if(c<s)return this.method="next",this.arg=t,r(s),!0;if(c<u)return r(u),!1}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[2]===t)return this.complete(n[4],n[3]),k(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]===t){var r=n[4];if("throw"===r.type){var o=r.arg;k(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={i:O(e),r:n,n:r},"next"===this.method&&(this.arg=t),f}},e}function En(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function kn(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){En(i,r,o,a,c,"next",t)}function c(t){En(i,r,o,a,c,"throw",t)}a(void 0)}))}}function Sn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,On(r.key),r)}}function On(t){var e=function(t){if("object"!=mn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=mn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==mn(e)?e:e+""}const Tn=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.dbName="StoryApp",this.version=1,this.db=null},e=[{key:"init",value:(c=kn(xn().mark((function t(){var e=this;return xn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.db){t.next=2;break}return t.abrupt("return",this.db);case 2:return t.abrupt("return",new Promise((function(t,n){var r=indexedDB.open(e.dbName,e.version);r.onsuccess=function(){e.db=r.result,console.log("IndexedDB initialized"),t(e.db)},r.onerror=function(){return n(r.error)},r.onupgradeneeded=function(t){e.db=t.target.result,e.db.objectStoreNames.contains("favorites")||e.db.createObjectStore("favorites",{keyPath:"id"})}})));case 3:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})},{key:"addFavorite",value:(a=kn(xn().mark((function t(e){var n=this;return xn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.init();case 2:return t.abrupt("return",new Promise((function(t,r){var o=n.db.transaction(["favorites"],"readwrite").objectStore("favorites").put(bn(bn({},e),{},{savedAt:Date.now()}));o.onsuccess=function(){return t()},o.onerror=function(){return r(o.error)}})));case 3:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"removeFavorite",value:(i=kn(xn().mark((function t(e){var n=this;return xn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.init();case 2:return t.abrupt("return",new Promise((function(t,r){var o=n.db.transaction(["favorites"],"readwrite").objectStore("favorites").delete(e);o.onsuccess=function(){return t()},o.onerror=function(){return r(o.error)}})));case 3:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"getFavorites",value:(o=kn(xn().mark((function t(){var e=this;return xn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.init();case 2:return t.abrupt("return",new Promise((function(t,n){var r=e.db.transaction(["favorites"],"readonly").objectStore("favorites").getAll();r.onsuccess=function(){return t(r.result||[])},r.onerror=function(){return n(r.error)}})));case 3:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"isFavorite",value:(r=kn(xn().mark((function t(e){var n=this;return xn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.init();case 2:return t.abrupt("return",new Promise((function(t,r){var o=n.db.transaction(["favorites"],"readonly").objectStore("favorites").get(e);o.onsuccess=function(){return t(!!o.result)},o.onerror=function(){return r(o.error)}})));case 3:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"clearAll",value:(n=kn(xn().mark((function t(){var e=this;return xn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.init();case 2:return t.abrupt("return",new Promise((function(t,n){var r=e.db.transaction(["favorites"],"readwrite").objectStore("favorites").clear();r.onsuccess=function(){return t()},r.onerror=function(){return n(r.error)}})));case 3:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})}],e&&Sn(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o,i,a,c}());function Pn(t){return Pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pn(t)}function _n(){_n=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function s(t,e,n,r){return Object.defineProperty(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function u(e,n,r,o){var i=n&&n.prototype instanceof h?n:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=x(c,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(e,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(e,r,new S(o||[])),!0),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var f={};function h(){}function p(){}function d(){}var v={};s(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(O([])));m&&m!==n&&r.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function n(o,i,a,c){var s=l(t[o],t,i);if("throw"!==s.type){var u=s.arg,f=u.value;return f&&"object"==Pn(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(f).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var o;s(this,"_invoke",(function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,n){var r=n.method,o=e.i[r];if(o===t)return n.delegate=null,"throw"===r&&e.i.return&&(n.method="return",n.arg=t,x(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var i=l(o,e.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,f;var a=i.arg;return a?a.done?(n[e.r]=a.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,f):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,f)}function E(t){this.tryEntries.push(t)}function k(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function S(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function O(e){if(null!=e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(Pn(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,c,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),s(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),s(g,c,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}},e.values=O,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t){a.type="throw",a.arg=e,n.next=t}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],c=this.prev,s=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!s&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=c){if(c<s)return this.method="next",this.arg=t,r(s),!0;if(c<u)return r(u),!1}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[2]===t)return this.complete(n[4],n[3]),k(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]===t){var r=n[4];if("throw"===r.type){var o=r.arg;k(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={i:O(e),r:n,n:r},"next"===this.method&&(this.arg=t),f}},e}function jn(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function An(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){jn(i,r,o,a,c,"next",t)}function c(t){jn(i,r,o,a,c,"throw",t)}a(void 0)}))}}function Ln(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Nn(r.key),r)}}function Nn(t){var e=function(t){if("object"!=Pn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Pn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Pn(e)?e:e+""}const Cn=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=e,this.currentStory=null},e=[{key:"init",value:(o=An(_n().mark((function t(e){var n;return _n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,pe.getStoryDetail(e);case 3:if(!(n=t.sent).story){t.next=9;break}return this.currentStory=n.story,this.view.displayStory(n.story),t.next=9,this.addFavoriteButton(n.story);case 9:t.next=15;break;case 11:t.prev=11,t.t0=t.catch(0),this.view.showError("Story not found or failed to load."),console.error("Error loading story detail:",t.t0);case 15:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(t){return o.apply(this,arguments)})},{key:"addFavoriteButton",value:(r=An(_n().mark((function t(e){var n=this;return _n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:setTimeout(An(_n().mark((function t(){var r,o,i;return _n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,r=document.querySelector(".story-detail")||document.querySelector(".container")){t.next=4;break}return t.abrupt("return");case 4:if(!document.getElementById("favorite-btn")){t.next=6;break}return t.abrupt("return");case 6:return t.next=8,Tn.isFavorite(e.id);case 8:o=t.sent,(i=document.createElement("button")).id="favorite-btn",i.innerHTML=o?" Remove from Favorites":" Add to Favorites",i.style.cssText="\n          background: ".concat(o?"#f44336":"#4CAF50","; \n          color: white; \n          padding: 12px 20px; \n          border: none; \n          border-radius: 6px; \n          cursor: pointer; \n          margin: 15px 0;\n          font-size: 16px;\n          display: block;\n          width: 100%;\n          max-width: 300px;\n        "),i.addEventListener("click",An(_n().mark((function t(){return _n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.toggleFavorite(e,i);case 2:case"end":return t.stop()}}),t)})))),r.appendChild(i),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(0),console.error("Error adding favorite button:",t.t0);case 20:case"end":return t.stop()}}),t,null,[[0,17]])}))),100);case 1:case"end":return t.stop()}}),t)}))),function(t){return r.apply(this,arguments)})},{key:"toggleFavorite",value:(n=An(_n().mark((function t(e,n){return _n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Tn.isFavorite(e.id);case 3:if(!t.sent){t.next=12;break}return t.next=7,Tn.removeFavorite(e.id);case 7:n.innerHTML=" Add to Favorites",n.style.background="#4CAF50",this.showMessage("Removed from favorites"),t.next=17;break;case 12:return t.next=14,Tn.addFavorite(e);case 14:n.innerHTML=" Remove from Favorites",n.style.background="#f44336",this.showMessage("Added to favorites");case 17:t.next=23;break;case 19:t.prev=19,t.t0=t.catch(0),console.error("Error toggling favorite:",t.t0),this.showMessage("Error updating favorites");case 23:case"end":return t.stop()}}),t,this,[[0,19]])}))),function(t,e){return n.apply(this,arguments)})},{key:"showMessage",value:function(t){var e=document.createElement("div");e.style.cssText="\n      position: fixed; \n      top: 20px; \n      right: 20px; \n      background: #4CAF50; \n      color: white; \n      padding: 12px 20px; \n      border-radius: 6px; \n      z-index: 1000;\n      box-shadow: 0 4px 8px rgba(0,0,0,0.2);\n    ",e.textContent=t,document.body.appendChild(e),setTimeout((function(){e.parentNode&&e.parentNode.removeChild(e)}),2e3)}}],e&&Ln(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o}();function In(t){return In="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},In(t)}function Mn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Fn(r.key),r)}}function Fn(t){var e=function(t){if("object"!=In(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=In(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==In(e)?e:e+""}const Dn=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},(e=[{key:"render",value:function(){return'\n        <div class="offline-page">\n          <div class="container">\n            <header class="page-header">\n              <h1> Offline Storage</h1>\n              <p>Manage your saved stories</p>\n            </header>\n  \n            <div class="offline-content">\n              <div class="storage-section">\n                <h2>Favorite Stories</h2>\n                <div id="favorites-list" class="stories-grid">\n                  <div class="loading">Loading favorites...</div>\n                </div>\n                <div class="actions">\n                  <button id="clear-favorites" class="btn-secondary">Clear All Favorites</button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n  \n        <style>\n          .offline-page {\n            padding: 20px;\n            max-width: 1000px;\n            margin: 0 auto;\n          }\n  \n          .page-header {\n            text-align: center;\n            margin-bottom: 30px;\n          }\n  \n          .page-header h1 {\n            margin: 0 0 10px 0;\n            font-size: 2rem;\n          }\n  \n          .storage-section {\n            background: white;\n            padding: 20px;\n            border-radius: 8px;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n            margin-bottom: 20px;\n          }\n  \n          .stories-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));\n            gap: 20px;\n            margin: 20px 0;\n          }\n  \n          .story-card {\n            border: 1px solid #ddd;\n            border-radius: 8px;\n            padding: 15px;\n            background: #f9f9f9;\n          }\n  \n          .story-card img {\n            width: 100%;\n            height: 150px;\n            object-fit: cover;\n            border-radius: 4px;\n            margin-bottom: 10px;\n          }\n  \n          .story-card h3 {\n            margin: 0 0 8px 0;\n            font-size: 1.1rem;\n          }\n  \n          .story-card p {\n            margin: 0 0 10px 0;\n            color: #666;\n            font-size: 0.9rem;\n          }\n  \n          .story-actions {\n            display: flex;\n            gap: 8px;\n          }\n  \n          .btn-small {\n            padding: 5px 10px;\n            font-size: 0.8rem;\n            border: none;\n            border-radius: 4px;\n            cursor: pointer;\n          }\n  \n          .btn-view {\n            background: #2196F3;\n            color: white;\n          }\n  \n          .btn-remove {\n            background: #f44336;\n            color: white;\n          }\n  \n          .btn-secondary {\n            background: #666;\n            color: white;\n            padding: 10px 20px;\n            border: none;\n            border-radius: 4px;\n            cursor: pointer;\n          }\n  \n          .loading, .empty-state {\n            text-align: center;\n            padding: 40px;\n            color: #666;\n            grid-column: 1 / -1;\n          }\n  \n          .actions {\n            text-align: center;\n            margin-top: 20px;\n          }\n        </style>\n      '}}])&&Mn(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Rn(t){return Rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rn(t)}function Gn(){Gn=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function s(t,e,n,r){return Object.defineProperty(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function u(e,n,r,o){var i=n&&n.prototype instanceof h?n:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=x(c,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(e,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(e,r,new S(o||[])),!0),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var f={};function h(){}function p(){}function d(){}var v={};s(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(O([])));m&&m!==n&&r.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function n(o,i,a,c){var s=l(t[o],t,i);if("throw"!==s.type){var u=s.arg,f=u.value;return f&&"object"==Rn(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(f).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var o;s(this,"_invoke",(function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,n){var r=n.method,o=e.i[r];if(o===t)return n.delegate=null,"throw"===r&&e.i.return&&(n.method="return",n.arg=t,x(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var i=l(o,e.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,f;var a=i.arg;return a?a.done?(n[e.r]=a.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,f):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,f)}function E(t){this.tryEntries.push(t)}function k(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function S(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function O(e){if(null!=e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(Rn(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,c,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),s(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),s(g,c,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}},e.values=O,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t){a.type="throw",a.arg=e,n.next=t}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],c=this.prev,s=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!s&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=c){if(c<s)return this.method="next",this.arg=t,r(s),!0;if(c<u)return r(u),!1}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[2]===t)return this.complete(n[4],n[3]),k(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]===t){var r=n[4];if("throw"===r.type){var o=r.arg;k(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={i:O(e),r:n,n:r},"next"===this.method&&(this.arg=t),f}},e}function Bn(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function zn(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Bn(i,r,o,a,c,"next",t)}function c(t){Bn(i,r,o,a,c,"throw",t)}a(void 0)}))}}function Un(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Hn(r.key),r)}}function Hn(t){var e=function(t){if("object"!=Rn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Rn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Rn(e)?e:e+""}const qn=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=e},e=[{key:"init",value:(i=zn(Gn().mark((function t(){return Gn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.loadFavorites();case 3:this.attachEventListeners(),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.error("Error initializing offline page:",t.t0);case 9:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(){return i.apply(this,arguments)})},{key:"attachEventListeners",value:function(){var t,e=this;null===(t=document.getElementById("clear-favorites"))||void 0===t||t.addEventListener("click",(function(){e.clearFavorites()}))}},{key:"loadFavorites",value:(o=zn(Gn().mark((function t(){var e,n,r=this;return Gn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=document.getElementById("favorites-list")){t.next=3;break}return t.abrupt("return");case 3:return t.prev=3,t.next=6,Tn.getFavorites();case 6:if(0!==(n=t.sent).length){t.next=10;break}return e.innerHTML='<div class="empty-state">No favorite stories saved yet.</div>',t.abrupt("return");case 10:e.innerHTML=n.map((function(t){return r.createStoryCard(t)})).join(""),this.attachCardListeners(),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(3),e.innerHTML='<div class="empty-state">Error loading favorites.</div>';case 17:case"end":return t.stop()}}),t,this,[[3,14]])}))),function(){return o.apply(this,arguments)})},{key:"createStoryCard",value:function(t){return'\n      <div class="story-card">\n        <img src="'.concat(t.photoUrl,'" alt="').concat(t.description,'" loading="lazy">\n        <h3>').concat(t.name,"</h3>\n        <p>").concat(t.description,'</p>\n        <div class="story-actions">\n          <button class="btn-small btn-view" data-action="view" data-id="').concat(t.id,'">View</button>\n          <button class="btn-small btn-remove" data-action="remove" data-id="').concat(t.id,'">Remove</button>\n        </div>\n      </div>\n    ')}},{key:"attachCardListeners",value:function(){var t=this;document.querySelectorAll("[data-action]").forEach((function(e){e.addEventListener("click",function(){var e=zn(Gn().mark((function e(n){var r,o;return Gn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.target.dataset.action,o=n.target.dataset.id,"view"!==r){e.next=7;break}window.history.pushState({},"","/story/".concat(o)),window.dispatchEvent(new PopStateEvent("popstate")),e.next=10;break;case 7:if("remove"!==r){e.next=10;break}return e.next=10,t.removeFavorite(o);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))}},{key:"removeFavorite",value:(r=zn(Gn().mark((function t(e){return Gn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Tn.removeFavorite(e);case 3:return t.next=5,this.loadFavorites();case 5:this.showMessage("Removed from favorites"),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),this.showMessage("Failed to remove favorite");case 11:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(t){return r.apply(this,arguments)})},{key:"clearFavorites",value:(n=zn(Gn().mark((function t(){return Gn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(confirm("Clear all favorites?")){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,Tn.clearAll();case 5:return t.next=7,this.loadFavorites();case 7:this.showMessage("All favorites cleared"),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),this.showMessage("Failed to clear favorites");case 13:case"end":return t.stop()}}),t,this,[[2,10]])}))),function(){return n.apply(this,arguments)})},{key:"showMessage",value:function(t){var e=document.createElement("div");e.style.cssText="\n      position: fixed; top: 20px; right: 20px; \n      background: #4CAF50; color: white; padding: 10px 15px; \n      border-radius: 4px; z-index: 1000;\n    ",e.textContent=t,document.body.appendChild(e),setTimeout((function(){return e.remove()}),2e3)}}],e&&Un(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o,i}();function Wn(t){return Wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wn(t)}function Yn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Vn(r.key),r)}}function Vn(t){var e=function(t){if("object"!=Wn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Wn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Wn(e)?e:e+""}const Kn=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"render",value:function(){var t=document.getElementById("app-header");if(t){var e=!1,n="User";try{if(e=ee.isAuthenticated()){var r=ee.getCurrentUser();n=(null==r?void 0:r.name)||"User"}}catch(t){console.error("Error checking authentication:",t),e=!1}var o=window.location.pathname;t.innerHTML='\n      <nav class="main-navigation" role="navigation" aria-label="Main navigation">\n        <div class="nav-container">\n          <div class="nav-brand">\n            <a href="/" class="brand-link" data-route="/">\n               Dicoding Story\n            </a>\n          </div>\n          \n          <button class="nav-toggle" aria-label="Toggle navigation menu">\n            <span></span>\n            <span></span>\n            <span></span>\n          </button>\n\n          <div class="nav-menu">\n            <div class="nav-links">\n              <a href="/" class="nav-link '.concat("/"===o?"active":"",'" data-route="/">\n                 Home\n              </a>\n              \n              <a href="/offline" class="nav-link ').concat("/offline"===o?"active":"",'" data-route="/offline">\n                 Offline\n              </a>\n\n              ').concat(e?'\n                <a href="/add" class="nav-link '.concat("/add"===o?"active":"",'" data-route="/add">\n                   Add Story\n                </a>\n                <button class="nav-link logout-btn" id="logout-btn">\n                   Logout\n                </button>\n              '):'\n                <a href="/login" class="nav-link '.concat("/login"===o?"active":"",'" data-route="/login">\n                   Login\n                </a>\n                <a href="/register" class="nav-link ').concat("/register"===o?"active":"",'" data-route="/register">\n                   Register\n                </a>\n              '),"\n            </div>\n\n            ").concat(e?'\n              <div class="nav-user">\n                <span class="user-greeting">\n                   '.concat(n,"\n                </span>\n              </div>\n            "):"","\n          </div>\n        </div>\n      </nav>\n\n      <style>\n        .main-navigation {\n          background: #2196F3;\n          color: white;\n          box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n          position: sticky;\n          top: 0;\n          z-index: 100;\n        }\n\n        .nav-container {\n          max-width: 1200px;\n          margin: 0 auto;\n          padding: 0 20px;\n          display: flex;\n          align-items: center;\n          justify-content: space-between;\n          min-height: 60px;\n        }\n\n        .nav-brand .brand-link {\n          color: white;\n          text-decoration: none;\n          font-size: 1.5rem;\n          font-weight: bold;\n          display: flex;\n          align-items: center;\n          gap: 8px;\n        }\n\n        .nav-toggle {\n          display: none;\n          flex-direction: column;\n          background: none;\n          border: none;\n          cursor: pointer;\n          padding: 8px;\n        }\n\n        .nav-toggle span {\n          width: 25px;\n          height: 3px;\n          background: white;\n          margin: 3px 0;\n          border-radius: 2px;\n          transition: 0.3s;\n        }\n\n        .nav-menu {\n          display: flex;\n          align-items: center;\n          gap: 20px;\n        }\n\n        .nav-links {\n          display: flex;\n          align-items: center;\n          gap: 10px;\n        }\n\n        .nav-link {\n          color: white;\n          text-decoration: none;\n          padding: 8px 16px;\n          border-radius: 6px;\n          transition: all 0.2s;\n          background: none;\n          border: none;\n          cursor: pointer;\n          font-size: 0.95rem;\n          display: flex;\n          align-items: center;\n          gap: 6px;\n        }\n\n        .nav-link:hover {\n          background: rgba(255, 255, 255, 0.1);\n        }\n\n        .nav-link.active {\n          background: rgba(255, 255, 255, 0.2);\n          font-weight: 500;\n        }\n\n        .logout-btn {\n          color: #ffcdd2;\n          border-left: 1px solid rgba(255, 255, 255, 0.2);\n          margin-left: 10px;\n          padding-left: 20px;\n        }\n\n        .logout-btn:hover {\n          background: rgba(244, 67, 54, 0.2);\n        }\n\n        .nav-user {\n          display: flex;\n          align-items: center;\n          gap: 10px;\n        }\n\n        .user-greeting {\n          font-size: 0.9rem;\n          opacity: 0.9;\n          padding: 8px 12px;\n          background: rgba(255, 255, 255, 0.1);\n          border-radius: 20px;\n        }\n\n        @media (max-width: 768px) {\n          .nav-toggle {\n            display: flex;\n          }\n\n          .nav-menu {\n            position: absolute;\n            top: 100%;\n            left: 0;\n            right: 0;\n            background: #2196F3;\n            flex-direction: column;\n            padding: 20px;\n            gap: 10px;\n            transform: translateY(-100%);\n            opacity: 0;\n            visibility: hidden;\n            transition: all 0.3s;\n          }\n\n          .nav-menu.active {\n            transform: translateY(0);\n            opacity: 1;\n            visibility: visible;\n          }\n\n          .nav-links {\n            flex-direction: column;\n            width: 100%;\n            gap: 5px;\n          }\n\n          .nav-link {\n            padding: 12px 16px;\n            width: 100%;\n            text-align: left;\n            justify-content: flex-start;\n          }\n\n          .logout-btn {\n            border-left: none;\n            border-top: 1px solid rgba(255, 255, 255, 0.2);\n            margin-left: 0;\n            margin-top: 10px;\n            padding-left: 16px;\n            padding-top: 20px;\n          }\n\n          .nav-user {\n            width: 100%;\n            justify-content: center;\n            margin-top: 10px;\n            padding-top: 10px;\n            border-top: 1px solid rgba(255, 255, 255, 0.2);\n          }\n        }\n      </style>\n    "),this.attachEventListeners()}}},{key:"attachEventListeners",value:function(){document.querySelectorAll("[data-route]").forEach((function(t){t.addEventListener("click",(function(t){t.preventDefault();var e=t.currentTarget.getAttribute("data-route");tr.navigateTo(e)}))}));var t=document.getElementById("logout-btn");t&&t.addEventListener("click",(function(){try{ee.logout(),tr.navigateTo("/"),window.dispatchEvent(new CustomEvent("auth-changed"))}catch(t){console.error("Error during logout:",t)}}));var e=document.querySelector(".nav-toggle"),n=document.querySelector(".nav-menu");e&&n&&(e.addEventListener("click",(function(){n.classList.toggle("active")})),document.addEventListener("click",(function(t){e.contains(t.target)||n.contains(t.target)||n.classList.remove("active")})),document.querySelectorAll(".nav-link").forEach((function(t){t.addEventListener("click",(function(){n.classList.remove("active")}))})))}}],e&&Yn(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Jn(t){return Jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jn(t)}function Xn(){Xn=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function s(t,e,n,r){return Object.defineProperty(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function u(e,n,r,o){var i=n&&n.prototype instanceof h?n:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=x(c,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(e,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(e,r,new S(o||[])),!0),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var f={};function h(){}function p(){}function d(){}var v={};s(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(O([])));m&&m!==n&&r.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function n(o,i,a,c){var s=l(t[o],t,i);if("throw"!==s.type){var u=s.arg,f=u.value;return f&&"object"==Jn(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(f).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var o;s(this,"_invoke",(function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,n){var r=n.method,o=e.i[r];if(o===t)return n.delegate=null,"throw"===r&&e.i.return&&(n.method="return",n.arg=t,x(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var i=l(o,e.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,f;var a=i.arg;return a?a.done?(n[e.r]=a.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,f):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,f)}function E(t){this.tryEntries.push(t)}function k(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function S(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function O(e){if(null!=e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(Jn(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,c,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),s(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),s(g,c,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}},e.values=O,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t){a.type="throw",a.arg=e,n.next=t}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],c=this.prev,s=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!s&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=c){if(c<s)return this.method="next",this.arg=t,r(s),!0;if(c<u)return r(u),!1}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[2]===t)return this.complete(n[4],n[3]),k(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]===t){var r=n[4];if("throw"===r.type){var o=r.arg;k(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={i:O(e),r:n,n:r},"next"===this.method&&(this.arg=t),f}},e}function $n(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function Zn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Qn(r.key),r)}}function Qn(t){var e=function(t){if("object"!=Jn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Jn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Jn(e)?e:e+""}const tr=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.routes={"/":{page:ie,presenter:Pe,requiresAuth:!1},"/login":{page:Le,presenter:De,requiresAuth:!1},"/register":{page:ze,presenter:Ve,requiresAuth:!1},"/add":{page:on,presenter:hn,requiresAuth:!0},"/story/:id":{page:yn,presenter:Cn,requiresAuth:!1},"/offline":{page:Dn,presenter:qn,requiresAuth:!1}},this.navigation=new Kn}return e=t,n=[{key:"init",value:function(){this.navigation.render(),this.handleRoute()}},{key:"handleRoute",value:function(){var e=window.location.pathname;e.startsWith("/story-sharing-app")&&(e=e.replace("/story-sharing-app","")||"/");var n=this.findRoute(e);n?!n.requiresAuth||ee.isAuthenticated()?this.renderPage(n,e):t.navigateTo("/login"):t.navigateTo("/")}},{key:"findRoute",value:function(t){if(this.routes[t])return this.routes[t];for(var e in this.routes)if(e.includes(":")&&new RegExp("^"+e.replace(/:([^/]+)/g,"([^/]+)")+"$").test(t))return this.routes[e];return null}},{key:"renderPage",value:(o=Xn().mark((function t(e,n){var r,o,i,a,c,s,u;return Xn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=document.getElementById("main-content")){t.next=4;break}return console.error("Main content container not found"),t.abrupt("return");case 4:if(t.prev=4,r.innerHTML='<div class="loading-spinner" style="text-align: center; padding: 50px;">Loading...</div>',o=new e.page,i=o.render(),r.innerHTML=i,a=new e.presenter(o),c=null,n.includes("/story/")&&(c=n.split("/story/")[1],console.log("Extracted story ID:",c)),s=null,n.includes("/add")&&(u=new URLSearchParams(window.location.search),(s=u.get("draft"))&&console.log("Extracted draft ID:",s)),!c){t.next=19;break}return t.next=17,a.init(c);case 17:t.next=27;break;case 19:if(!s){t.next=25;break}return a.draftId=s,t.next=23,a.init();case 23:t.next=27;break;case 25:return t.next=27,a.init();case 27:t.next=33;break;case 29:t.prev=29,t.t0=t.catch(4),console.error("Error rendering page:",t.t0),r.innerHTML='\n        <div class="error-message" style="text-align: center; padding: 50px; color: #f44336;">\n          <h2>Something went wrong</h2>\n          <p>Please try refreshing the page.</p>\n          <button onclick="location.reload()" style="padding: 10px 20px; background: #2196F3; color: white; border: none; border-radius: 4px; cursor: pointer;">\n            Refresh\n          </button>\n        </div>\n      ';case 33:case"end":return t.stop()}}),t,null,[[4,29]])})),i=function(){var t=this,e=arguments;return new Promise((function(n,r){var i=o.apply(t,e);function a(t){$n(i,n,r,a,c,"next",t)}function c(t){$n(i,n,r,a,c,"throw",t)}a(void 0)}))},function(t,e){return i.apply(this,arguments)})}],r=[{key:"navigateTo",value:function(t){var e=""+t;window.history.pushState({},"",e),window.dispatchEvent(new PopStateEvent("popstate"))}}],n&&Zn(e.prototype,n),r&&Zn(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,r,o,i}();function er(t){return er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},er(t)}function nr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function rr(t,e,n){return(e=sr(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function or(){or=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function s(t,e,n,r){return Object.defineProperty(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function u(e,n,r,o){var i=n&&n.prototype instanceof h?n:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=x(c,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(e,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(e,r,new S(o||[])),!0),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var f={};function h(){}function p(){}function d(){}var v={};s(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(O([])));m&&m!==n&&r.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function n(o,i,a,c){var s=l(t[o],t,i);if("throw"!==s.type){var u=s.arg,f=u.value;return f&&"object"==er(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(f).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var o;s(this,"_invoke",(function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,n){var r=n.method,o=e.i[r];if(o===t)return n.delegate=null,"throw"===r&&e.i.return&&(n.method="return",n.arg=t,x(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var i=l(o,e.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,f;var a=i.arg;return a?a.done?(n[e.r]=a.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,f):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,f)}function E(t){this.tryEntries.push(t)}function k(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function S(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function O(e){if(null!=e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(er(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,c,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),s(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),s(g,c,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}},e.values=O,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t){a.type="throw",a.arg=e,n.next=t}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],c=this.prev,s=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!s&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=c){if(c<s)return this.method="next",this.arg=t,r(s),!0;if(c<u)return r(u),!1}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[2]===t)return this.complete(n[4],n[3]),k(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]===t){var r=n[4];if("throw"===r.type){var o=r.arg;k(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={i:O(e),r:n,n:r},"next"===this.method&&(this.arg=t),f}},e}function ir(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function ar(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){ir(i,r,o,a,c,"next",t)}function c(t){ir(i,r,o,a,c,"throw",t)}a(void 0)}))}}function cr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,sr(r.key),r)}}function sr(t){var e=function(t){if("object"!=er(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=er(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==er(e)?e:e+""}var ur=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"init",value:(c=ar(or().mark((function t(e){var n;return or().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log(" Initializing NotificationService..."),t.next=4,Notification.requestPermission();case 4:if(n=t.sent,console.log(" Notification permission:",n),"granted"!==n){t.next=17;break}if(!Kt.getToken()){t.next=14;break}return console.log(" User authenticated, attempting subscription..."),t.next=12,this.subscribe(e);case 12:t.next=15;break;case 14:console.log(" No authentication token found");case 15:t.next=18;break;case 17:console.log(" Notification permission denied");case 18:t.next=23;break;case 20:t.prev=20,t.t0=t.catch(0),console.error(" Failed to initialize notifications:",t.t0);case 23:case"end":return t.stop()}}),t,this,[[0,20]])}))),function(t){return c.apply(this,arguments)})},{key:"subscribe",value:(a=ar(or().mark((function t(e){var n,r,o,i,a,c;return or().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=Kt.getToken()){t.next=5;break}return console.warn(" No authentication token found"),t.abrupt("return");case 5:return console.log(" Starting push notification subscription process..."),t.next=8,e.pushManager.getSubscription();case 8:if(!(r=t.sent)){t.next=14;break}return console.log(" Found existing subscription"),t.next=13,this.sendSubscriptionToServer(r,n);case 13:return t.abrupt("return");case 14:return console.log(" Converting VAPID key..."),o=this.urlBase64ToUint8Array("BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk"),console.log(" VAPID key converted successfully"),console.log(" Attempting browser push subscription..."),t.next=20,e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:o});case 20:return i=t.sent,console.log(" Browser push subscription successful!"),t.next=24,this.sendSubscriptionToServer(i,n);case 24:t.next=44;break;case 26:if(t.prev=26,t.t0=t.catch(0),console.error(" Failed to subscribe to push notifications:",t.t0),a=Kt.getToken()){t.next=33;break}return console.error(" No token available for fallback subscription"),t.abrupt("return");case 33:return t.prev=33,console.log(" Creating fallback subscription for API testing..."),c={endpoint:"https://fcm.googleapis.com/fcm/send/test_".concat(Date.now()),getKey:function(t){return{p256dh:new Uint8Array(65).fill(1),auth:new Uint8Array(16).fill(2)}[t]}},console.log(" Fallback subscription created"),t.next=39,this.sendSubscriptionToServer(c,a);case 39:t.next=44;break;case 41:t.prev=41,t.t1=t.catch(33),console.error(" Fallback subscription also failed:",t.t1);case 44:case"end":return t.stop()}}),t,this,[[0,26],[33,41]])}))),function(t){return a.apply(this,arguments)})},{key:"sendSubscriptionToServer",value:(i=ar(or().mark((function t(e,n){var r,o,i,a;return or().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log(" Preparing subscription data for server..."),r={endpoint:e.endpoint,keys:{p256dh:e.getKey?btoa(String.fromCharCode.apply(null,new Uint8Array(e.getKey("p256dh")))):btoa("mock_p256dh_key_for_testing"),auth:e.getKey?btoa(String.fromCharCode.apply(null,new Uint8Array(e.getKey("auth")))):btoa("mock_auth_key_for_testing")}},console.log(" Sending subscription to Dicoding API..."),console.log(" Endpoint:","".concat(Et).concat(Pt)),t.next=7,fetch("".concat(Et).concat(Pt),{method:"POST",headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},body:JSON.stringify(r)});case 7:if(o=t.sent,console.log(" Server response status:",o.status,o.statusText),o.ok){t.next=15;break}return t.next=12,o.text();case 12:throw i=t.sent,console.error(" Server error:",i),new Error("HTTP ".concat(o.status,": ").concat(i));case 15:return t.next=17,o.json();case 17:return a=t.sent,console.log(" Server response:",a),console.log(" Successfully registered with push notification service!"),console.log(" Push notification setup completed successfully!"),console.log(" Subscription type:",e.getKey?"Real browser push":"API integration test"),this.showLocalNotification(" Push Notifications Enabled!",{body:e.getKey?"You'll receive push notifications for new stories.":"Push notification API integration successful!",icon:this.createNotificationIcon("")}),t.abrupt("return",!0);case 26:return t.prev=26,t.t0=t.catch(0),console.error(" Failed to send subscription to server:",t.t0),t.abrupt("return",!1);case 30:case"end":return t.stop()}}),t,this,[[0,26]])}))),function(t,e){return i.apply(this,arguments)})},{key:"unsubscribe",value:(o=ar(or().mark((function t(){var e,n,r,o;return or().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=Kt.getToken()){t.next=5;break}return console.warn(" No authentication token found"),t.abrupt("return");case 5:return t.next=7,navigator.serviceWorker.ready;case 7:return n=t.sent,t.next=10,n.pushManager.getSubscription();case 10:if(!(r=t.sent)){t.next=21;break}return o={endpoint:r.endpoint},t.next=15,fetch("".concat(Et).concat(_t),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(o)});case 15:return t.sent.ok&&console.log(" Server unsubscribe successful"),t.next=19,r.unsubscribe();case 19:console.log(" Successfully unsubscribed from push notifications"),this.showLocalNotification(" Push Notifications Disabled",{body:"You will no longer receive push notifications."});case 21:t.next=26;break;case 23:t.prev=23,t.t0=t.catch(0),console.error(" Failed to unsubscribe from push notifications:",t.t0);case 26:case"end":return t.stop()}}),t,this,[[0,23]])}))),function(){return o.apply(this,arguments)})},{key:"showLocalNotification",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("Notification"in window&&"granted"===Notification.permission){var n=new Notification(t,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?nr(Object(n),!0).forEach((function(e){rr(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({icon:e.icon||this.createNotificationIcon(""),badge:this.createNotificationIcon("DS"),requireInteraction:!1,silent:!1},e));return setTimeout((function(){n.close()}),4e3),n}}},{key:"createNotificationIcon",value:function(t){return"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Crect width='64' height='64' fill='%232196F3' rx='8'/%3E%3Ctext x='32' y='40' text-anchor='middle' font-size='24' fill='white' font-family='Arial'%3E".concat(encodeURIComponent(t),"%3C/text%3E%3C/svg%3E")}},{key:"showNotification",value:(r=ar(or().mark((function t(e,n){var r;return or().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!("serviceWorker"in navigator)){t.next=9;break}return t.next=4,navigator.serviceWorker.ready;case 4:return r=t.sent,t.next=7,r.showNotification(e,n);case 7:t.next=10;break;case 9:this.showLocalNotification(e,n);case 10:t.next=16;break;case 12:t.prev=12,t.t0=t.catch(0),console.warn("Service worker notification failed, using fallback:",t.t0),this.showLocalNotification(e,n);case 16:case"end":return t.stop()}}),t,this,[[0,12]])}))),function(t,e){return r.apply(this,arguments)})},{key:"urlBase64ToUint8Array",value:function(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),n=window.atob(e),r=new Uint8Array(n.length),o=0;o<n.length;++o)r[o]=n.charCodeAt(o);return r}},{key:"testPushNotification",value:(n=ar(or().mark((function t(){var e;return or().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!("serviceWorker"in navigator)){t.next=9;break}return t.next=4,navigator.serviceWorker.ready;case 4:return e=t.sent,t.next=7,e.showNotification(" Test Push Notification",{body:"Jika notifikasi ini muncul, berarti push notification berfungsi!",icon:this.createNotificationIcon(""),badge:this.createNotificationIcon("DS"),vibrate:[200,100,200],data:{test:!0}});case 7:return console.log(" Test notification shown"),t.abrupt("return",!0);case 9:t.next=15;break;case 11:return t.prev=11,t.t0=t.catch(0),console.error(" Test notification failed:",t.t0),t.abrupt("return",!1);case 15:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(){return n.apply(this,arguments)})}],e&&cr(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o,i,a,c}();const lr=ur;function fr(t){return fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fr(t)}function hr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,pr(r.key),r)}}function pr(t){var e=function(t){if("object"!=fr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=fr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==fr(e)?e:e+""}var dr=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"init",value:function(){var t=this,e=document.querySelector(".skip-to-content");e&&(e.addEventListener("click",(function(e){e.preventDefault(),t.focusMainContent()})),e.addEventListener("focus",(function(){e.classList.add("focused")})),e.addEventListener("blur",(function(){e.classList.remove("focused")})),e.addEventListener("focusin",(function(){t.isKeyboardEvent()&&e.classList.add("focused")})),e.addEventListener("focusout",(function(){e.classList.remove("focused")})))}},{key:"focusMainContent",value:function(){var t=document.getElementById("main-content");t&&(t.setAttribute("tabindex","-1"),t.focus(),t.scrollIntoView({behavior:"smooth",block:"start"}),setTimeout((function(){t.removeAttribute("tabindex")}),1e3))}},{key:"isKeyboardEvent",value:function(){return document.documentElement.classList.contains("keyboard-user")||this.wasKeyboardUsedRecently()}},{key:"wasKeyboardUsedRecently",value:function(){return"keyboard"===document.documentElement.getAttribute("data-last-input")}}],null&&hr(t.prototype,null),e&&hr(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();document.addEventListener("keydown",(function(){document.documentElement.classList.add("keyboard-user"),document.documentElement.setAttribute("data-last-input","keyboard")})),document.addEventListener("mousedown",(function(){document.documentElement.classList.remove("keyboard-user"),document.documentElement.setAttribute("data-last-input","mouse")})),document.addEventListener("touchstart",(function(){document.documentElement.classList.remove("keyboard-user"),document.documentElement.setAttribute("data-last-input","touch")}));const vr=dr;function yr(t){return yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yr(t)}function mr(){mr=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function s(t,e,n,r){return Object.defineProperty(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function u(e,n,r,o){var i=n&&n.prototype instanceof h?n:h,a=Object.create(i.prototype);return s(a,"_invoke",function(e,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=x(c,r);if(s){if(s===f)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(e,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(e,r,new S(o||[])),!0),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var f={};function h(){}function p(){}function d(){}var v={};s(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(O([])));m&&m!==n&&r.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function n(o,i,a,c){var s=l(t[o],t,i);if("throw"!==s.type){var u=s.arg,f=u.value;return f&&"object"==yr(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(f).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var o;s(this,"_invoke",(function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(e,n){var r=n.method,o=e.i[r];if(o===t)return n.delegate=null,"throw"===r&&e.i.return&&(n.method="return",n.arg=t,x(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var i=l(o,e.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,f;var a=i.arg;return a?a.done?(n[e.r]=a.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,f):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,f)}function E(t){this.tryEntries.push(t)}function k(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function S(t){this.tryEntries=[[-1]],t.forEach(E,this),this.reset(!0)}function O(e){if(null!=e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(yr(e)+" is not iterable")}return p.prototype=d,s(g,"constructor",d),s(d,"constructor",p),p.displayName=s(d,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,c,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},b(w.prototype),s(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),s(g,c,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}},e.values=O,S.prototype={constructor:S,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t){a.type="throw",a.arg=e,n.next=t}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],c=this.prev,s=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!s&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=c){if(c<s)return this.method="next",this.arg=t,r(s),!0;if(c<u)return r(u),!1}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[2]===t)return this.complete(n[4],n[3]),k(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]===t){var r=n[4];if("throw"===r.type){var o=r.arg;k(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={i:O(e),r:n,n:r},"next"===this.method&&(this.arg=t),f}},e}function gr(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function br(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){gr(i,r,o,a,c,"next",t)}function c(t){gr(i,r,o,a,c,"throw",t)}a(void 0)}))}}function wr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,xr(r.key),r)}}function xr(t){var e=function(t){if("object"!=yr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=yr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==yr(e)?e:e+""}var Er=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.router=new tr,this.init()},e=[{key:"init",value:(n=br(mr().mark((function t(){var e,n,r=this;return mr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.router.init(),vr.init(),!("serviceWorker"in navigator)){t.next=22;break}return t.prev=3,e="./sw-dev.js",console.log("Registering service worker:",e),t.next=8,navigator.serviceWorker.register(e);case 8:return n=t.sent,console.log("Service Worker registered:",n),t.next=12,navigator.serviceWorker.ready;case 12:if(console.log("Service Worker is ready"),!ee.isAuthenticated()){t.next=16;break}return t.next=16,lr.init(n);case 16:n.addEventListener("updatefound",(function(){console.log("Service Worker update found")})),t.next=22;break;case 19:t.prev=19,t.t0=t.catch(3),console.error("Service Worker registration failed:",t.t0);case 22:window.addEventListener("auth-changed",br(mr().mark((function t(){var e;return mr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.router.navigation&&r.router.navigation.render(),r.router.handleRoute(),!ee.isAuthenticated()){t.next=14;break}return t.prev=3,t.next=6,navigator.serviceWorker.ready;case 6:return e=t.sent,t.next=9,lr.init(e);case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(3),console.error("Failed to initialize notifications:",t.t0);case 14:case"end":return t.stop()}}),t,null,[[3,11]])})))),window.addEventListener("popstate",(function(){r.router.handleRoute()})),this.handleOfflineStatus(),this.handleInstallPrompt();case 26:case"end":return t.stop()}}),t,this,[[3,19]])}))),function(){return n.apply(this,arguments)})},{key:"handleOfflineStatus",value:function(){var t=this,e=function(){navigator.onLine?(console.log(" App is online"),t.hideOfflineBanner()):(console.log(" App is offline - using cached content"),t.showOfflineBanner())};e(),window.addEventListener("online",e),window.addEventListener("offline",e)}},{key:"showOfflineBanner",value:function(){var t=document.getElementById("offline-banner");t&&t.remove();var e=document.createElement("div");e.id="offline-banner",e.innerHTML='\n      <div style="\n        position: fixed; \n        top: 0; \n        left: 0; \n        right: 0; \n        background: #ff9800; \n        color: white; \n        text-align: center; \n        padding: 8px; \n        z-index: 9999;\n        font-size: 14px;\n      ">\n         You\'re offline - Viewing cached content\n      </div>\n    ',document.body.appendChild(e)}},{key:"hideOfflineBanner",value:function(){var t=document.getElementById("offline-banner");t&&t.remove()}},{key:"handleInstallPrompt",value:function(){var t;window.addEventListener("beforeinstallprompt",(function(e){e.preventDefault(),t=e;var n=document.createElement("button");n.textContent=" Install App",n.style.cssText="\n        position: fixed; bottom: 20px; right: 20px; \n        background: #2196F3; color: white; border: none; \n        padding: 10px 15px; border-radius: 25px; \n        cursor: pointer; z-index: 1000;\n        box-shadow: 0 2px 10px rgba(0,0,0,0.3);\n      ",n.addEventListener("click",br(mr().mark((function e(){var r,o;return mr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=9;break}return t.prompt(),e.next=4,t.userChoice;case 4:r=e.sent,o=r.outcome,console.log("Install prompt result:",o),t=null,n.remove();case 9:case"end":return e.stop()}}),e)})))),document.body.appendChild(n)})),window.addEventListener("appinstalled",(function(){console.log("PWA was installed")}))}}],e&&wr(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();document.addEventListener("DOMContentLoaded",(function(){document.getElementById("app")?new Er:console.error("Root element not found")}))})();